<!DOCTYPE html>
<html lang="zh-Hant">
    
    <head>
        <meta charset="utf-8" />
        <title>紫芸居八字排盤</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta content="zh-tw" http-equiv="Content-Language">
		<meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- meta name="apple-mobile-web-app-capable" content="yes" /-->
        <!--- meta name="apple-mobile-web-app-status-bar-style" content="black" /-->

        <script type="text/javascript" src="lib\jquery.js"></script> <!---- v2.1.3 ---->
        <script type="text/javascript" src="lib\jquery-ui.js"></script> <!---- v1.11.4 ---->
        <script type="text/javascript" src="script\系統設定.js"></script>
        <script type="text/javascript" src="lib\d3.v3.min.js"></script>
        <script type="text/javascript" src="lib\liquidFillGauge.js"></script>
        
        <script type="text/javascript" src="script\jQueryInitCtrl.js"></script>

        <link href="lib\jquery-ui.css" rel="stylesheet" type="text/css">
        <link href="style.css" rel="stylesheet" type="text/css">

        <!---script type="text/javascript" src="lib\jquery.ui.touch-punch.min.js"></script-->
    </head>
    
    <body>
		<script type="text/javascript" src="lib\bootstrap.min.js"></script>
        <link href="css\bootstrap.min.css" rel="stylesheet" type="text/css">
        <link href="css\bootstrap-theme.min.css" rel="stylesheet" type="text/css">
		
		<div id="DoBInputTbl" class="hidden-print">
        <table style="width: 606px">
            <tr>
                <td style="width: 92px">
                    <span lang="zh-tw">輸入曆法：</span>
                </td>
                <td style="width: 91px">
                    <input name="InputCal" type="radio" value="西曆" onchange="eCalTypeChange(this.value)" id="CalWestern">西曆</td>
                <td style="width: 95px">
                    <input name="InputCal" type="radio" value="農曆" onchange="eCalTypeChange(this.value)" id="CalNL">農曆</td>
                <td style="width: 95px">
                    <input name="InputCal" type="radio" value="干支曆" onchange="eCalTypeChange(this.value)" id="CalGZ">干支曆</td>
                <td style="width: 89px">&nbsp;</td>
                <td style="width: 44px">&nbsp;</td>
                <td style="width: 53px">&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td style="width: 92px">&nbsp;</td>
                <td style="width: 91px">
                    <span lang="zh-tw">年</span>
                </td>
                <td style="width: 95px">
                    <span lang="zh-tw">月</span>
                </td>
                <td style="width: 95px">
                    <span lang="zh-tw">日</span>
                </td>
                <td style="width: 89px" class="auto-style1">
                    <span lang="zh-tw">時辰</span>
                </td>
                <td style="width: 53px" class="auto-style1">
                    <span lang="zh-tw">小時</span>
                </td>
                <td class="auto-style1">
                    <span lang="zh-tw">分鐘</span>
                </td>
                <td style="width: 44px">
                    <label id="lblLeapMonth">閏月</label>
                </td>
            </tr>
            <tr>
                <td style="width: 92px">
                    <span lang="zh-tw">生日：</span>
                </td>
                <td style="width: 91px">
                    <select name="cboYear" id="InputYear">
                        <option>1924</option>
                        <option>1925</option>
                        <option>1926</option>
                        <option>1927</option>
                        <option>1928</option>
                        <option>1929</option>
                        <option>1930</option>
                        <option>1931</option>
                        <option>1932</option>
                        <option>1933</option>
                        <option>1934</option>
                        <option>1935</option>
                        <option>1936</option>
                        <option>1937</option>
                        <option>1938</option>
                        <option>1939</option>
                        <option>1940</option>
                        <option>1941</option>
                        <option>1942</option>
                        <option>1943</option>
                        <option>1944</option>
                        <option>1945</option>
                        <option>1946</option>
                        <option>1947</option>
                        <option>1948</option>
                        <option>1949</option>
                        <option>1950</option>
                        <option>1951</option>
                        <option>1952</option>
                        <option>1953</option>
                        <option>1954</option>
                        <option>1955</option>
                        <option>1956</option>
                        <option>1957</option>
                        <option>1958</option>
                        <option>1959</option>
                        <option>1960</option>
                        <option>1961</option>
                        <option>1962</option>
                        <option>1963</option>
                        <option>1964</option>
                        <option>1965</option>
                        <option>1966</option>
                        <option>1967</option>
                        <option>1968</option>
                        <option>1969</option>
                        <option>1970</option>
                        <option>1971</option>
                        <option selected="">1972</option>
                        <option>1973</option>
                        <option>1974</option>
                        <option>1975</option>
                        <option>1976</option>
                        <option>1977</option>
                        <option>1978</option>
                        <option>1979</option>
                        <option>1980</option>
                        <option>1981</option>
                        <option>1982</option>
                        <option>1983</option>
                        <option>1984</option>
                        <option>1985</option>
                        <option>1986</option>
                        <option>1987</option>
                        <option>1988</option>
                        <option>1989</option>
                        <option>1990</option>
                        <option>1991</option>
                        <option>1992</option>
                        <option>1993</option>
                        <option>1994</option>
                        <option>1995</option>
                        <option>1996</option>
                        <option>1997</option>
                        <option>1998</option>
                        <option>1999</option>
                        <option>2000</option>
                        <option>2001</option>
                        <option>2002</option>
                        <option>2003</option>
                        <option>2004</option>
                        <option>2005</option>
                        <option>2006</option>
                        <option>2007</option>
                        <option>2008</option>
                        <option>2009</option>
                        <option>2010</option>
                        <option>2011</option>
                        <option>2012</option>
                        <option>2013</option>
                        <option>2014</option>
                        <option>2015</option>
                        <option>2016</option>
                        <option>2017</option>
                        <option>2018</option>
                        <option>2019</option>
                        <option>2020</option>
                        <option>2021</option>
                        <option>2022</option>
                        <option>2023</option>
                        <option>2024</option>
                        <option>2025</option>
                        <option>2026</option>
                        <option>2027</option>
                        <option>2028</option>
                        <option>2029</option>
                        <option>2030</option>
                    </select>
                </td>
                <td style="width: 95px">
                    <select name="cboMonth" id="InputMonth">
                        <option value="01">1</option>
                        <option value="02">2</option>
                        <option value="03">3</option>
                        <option value="04">4</option>
                        <option value="05">5</option>
                        <option value="06" selected="">6</option>
                        <option value="07">7</option>
                        <option value="08">8</option>
                        <option value="09">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                    </select>
                </td>
                <td style="width: 95px">
                    <select name="cboDay" id="InputDay">
                        <option value="01">1</option>
                        <option value="02">2</option>
                        <option value="03">3</option>
                        <option value="04">4</option>
                        <option value="05">5</option>
                        <option value="06">6</option>
                        <option value="07">7</option>
                        <option value="08">8</option>
                        <option value="09">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15" selected="">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                        <option value="31">31</option>
                    </select>
                </td>
                <td style="width: 89px">
                    <select name="cboChHours" id="InputShiChen" onchange="eUpdateTime(this.value)">
                        <option value="早子">早子時</option>
                        <option value="丑">丑時</option>
                        <option value="寅">寅時</option>
                        <option value="卯">卯時</option>
                        <option value="辰">辰時</option>
                        <option value="巳">巳時</option>
                        <option value="午">午時</option>
                        <option value="未">未時</option>
                        <option value="申">申時</option>
                        <option value="酉">酉時</option>
                        <option value="戌">戌時</option>
                        <option value="亥">亥時</option>
                        <option value="夜子">夜子時</option>
                    </select>
                </td>
                <td style="width: 44px">
                    <select name="cboHour" id="InputHour" onchange="eUpdateShiChen(this.value)">
                        <option value="00">00</option>
                        <option value="01">01</option>
                        <option value="02">02</option>
                        <option value="03">03</option>
                        <option value="04">04</option>
                        <option value="05">05</option>
                        <option value="06">06</option>
                        <option value="07">07</option>
                        <option value="08">08</option>
                        <option value="09">09</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                    </select>
                </td>
                <td style="width: 53px">
                    <select name="cboMinute" id="InputMinute">
                        <option value="00">00</option>
                        <option value="01">01</option>
                        <option value="02">02</option>
                        <option value="03">03</option>
                        <option value="04">04</option>
                        <option value="05">05</option>
                        <option value="06">06</option>
                        <option value="07">07</option>
                        <option value="08">08</option>
                        <option value="09">09</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                        <option value="13">13</option>
                        <option value="14">14</option>
                        <option value="15">15</option>
                        <option value="16">16</option>
                        <option value="17">17</option>
                        <option value="18">18</option>
                        <option value="19">19</option>
                        <option value="20">20</option>
                        <option value="21">21</option>
                        <option value="22">22</option>
                        <option value="23">23</option>
                        <option value="24">24</option>
                        <option value="25">25</option>
                        <option value="26">26</option>
                        <option value="27">27</option>
                        <option value="28">28</option>
                        <option value="29">29</option>
                        <option value="30">30</option>
                        <option value="31">31</option>
                        <option value="32">32</option>
                        <option value="33">33</option>
                        <option value="34">34</option>
                        <option value="35">35</option>
                        <option value="36">36</option>
                        <option value="37">37</option>
                        <option value="38">38</option>
                        <option value="39">39</option>
                        <option value="40">40</option>
                        <option value="41">41</option>
                        <option value="42">42</option>
                        <option value="43">43</option>
                        <option value="44">44</option>
                        <option value="45">45</option>
                        <option value="46">46</option>
                        <option value="47">47</option>
                        <option value="48">48</option>
                        <option value="49">49</option>
                        <option value="50">50</option>
                        <option value="51">51</option>
                        <option value="52">52</option>
                        <option value="53">53</option>
                        <option value="54">54</option>
                        <option value="55">55</option>
                        <option value="56">56</option>
                        <option value="57">57</option>
                        <option value="58">58</option>
                        <option value="59">59</option>
                    </select>
                </td>
                <td>
                    <input name="chkLeapMonth" type="checkbox" value="false" id="chkRunMonth">
                </td>
            </tr>
            <tr>
                <td style="width: 92px">&nbsp;</td>
                <td style="width: 91px">
                    <span lang="zh-tw">
                        <label id="lblNianZhu">年柱</label>
                    </span>
                </td>
                <td style="width: 95px">
                    <span lang="zh-tw">
                        <label id="lblYueZhu">月柱</label>
                    </span>
                </td>
                <td style="width: 95px">
                    <span lang="zh-tw">
                        <label id="lblRiZhu">日柱</label>
                    </span>
                </td>
                <td style="width: 89px">
                    <span lang="zh-tw">
                        <label id="lblShiZhu">時柱</label>
                    </span>
                </td>
                <td style="width: 44px">&nbsp;</td>
                <td style="width: 53px">&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
            <tr>
                <td style="width: 92px">
                    <span lang="zh-tw">
                        <label id="lblGanZhiLiFa">干支曆法</label>
                    </span>
                </td>
                <td style="width: 91px">
                    <select name="cboNianGan" id="InputNianGan">
                        <option>甲</option>
                        <option>乙</option>
                        <option>丙</option>
                        <option>丁</option>
                        <option>戊</option>
                        <option>己</option>
                        <option>庚</option>
                        <option>辛</option>
                        <option>壬</option>
                        <option>癸</option>
                    </select>
                    <select name="cboNianZhi" id="InputNianZhi">
                        <option>子</option>
                        <option>丑</option>
                        <option>寅</option>
                        <option>卯</option>
                        <option>辰</option>
                        <option>巳</option>
                        <option>午</option>
                        <option>未</option>
                        <option>申</option>
                        <option>酉</option>
                        <option>戌</option>
                        <option>亥</option>
                    </select>
                </td>
                <td style="width: 95px">
                    <select name="cboYueGan" id="InputYueGan">
                        <option>甲</option>
                        <option>乙</option>
                        <option>丙</option>
                        <option>丁</option>
                        <option>戊</option>
                        <option>己</option>
                        <option>庚</option>
                        <option>辛</option>
                        <option>壬</option>
                        <option>癸</option>
                    </select>
                    <select name="cboYueZhi" id="InputYueZhi">
                        <option>子</option>
                        <option>丑</option>
                        <option>寅</option>
                        <option>卯</option>
                        <option>辰</option>
                        <option>巳</option>
                        <option>午</option>
                        <option>未</option>
                        <option>申</option>
                        <option>酉</option>
                        <option>戌</option>
                        <option>亥</option>
                    </select>
                </td>
                <td style="width: 95px">
                    <select name="cboRiGan" id="InputRiGan">
                        <option>甲</option>
                        <option>乙</option>
                        <option>丙</option>
                        <option>丁</option>
                        <option>戊</option>
                        <option>己</option>
                        <option>庚</option>
                        <option>辛</option>
                        <option>壬</option>
                        <option>癸</option>
                    </select>
                    <select name="cboRiZhi" id="InputRiZhi">
                        <option>子</option>
                        <option>丑</option>
                        <option>寅</option>
                        <option>卯</option>
                        <option>辰</option>
                        <option>巳</option>
                        <option>午</option>
                        <option>未</option>
                        <option>申</option>
                        <option>酉</option>
                        <option>戌</option>
                        <option>亥</option>
                    </select>
                </td>
                <td style="width: 89px">
                    <select name="cboShiGan" id="InputShiGan">
                        <option>甲</option>
                        <option>乙</option>
                        <option>丙</option>
                        <option>丁</option>
                        <option>戊</option>
                        <option>己</option>
                        <option>庚</option>
                        <option>辛</option>
                        <option>壬</option>
                        <option>癸</option>
                    </select>
                    <select name="cboShiZhi" id="InputShiZhi">
                        <option>子</option>
                        <option>丑</option>
                        <option>寅</option>
                        <option>卯</option>
                        <option>辰</option>
                        <option>巳</option>
                        <option>午</option>
                        <option>未</option>
                        <option>申</option>
                        <option>酉</option>
                        <option>戌</option>
                        <option>亥</option>
                    </select>
                </td>

            </tr>
            <tr>
                <td style="width: 92px">
                    <span lang="zh-tw">性別：</span>
                </td>
                <td style="width: 91px">
                    <select name="cboSexChar" id="InputGender" style="width: 42px">
                        <option>女</option>
                        <option selected="">男</option>
                    </select>
                </td>
                <td style="width: 95px">&nbsp;</td>
                <td style="width: 95px">
                    <!----button id="btnConvertBZ" onclick="轉換八字()">轉換八字</button-->
                    <button id="btnConvertBZ">轉換八字</button>
                </td>
                <td style="width: 89px">&nbsp;</td>
                <td style="width: 44px">&nbsp;</td>
                <td style="width: 53px">&nbsp;</td>
                <td>&nbsp;</td>
            </tr>
        </table>
        </div>
        
        <input type="hidden" id="GlobalWesternDoB" value="">
        <h5 id="BZWesternDate1"></h5>
        <h5 id="BZWesternDate2"></h5>


    <!---------------------------------- 建立八字命盤模塊 ---------------------------------->
    <div class="BaziChartDiv" id="BaziChart"></div>
    <div style="width: 500px" id="debuginfo"></div>
    <div id="dlg流運分析" title="流運分析"></div>

												  
    <!---------------------------------- 命盤論斷註解 ---------------------------------->
<div id="tabbed-nav" class="NavTab">
  <ul>
    <li><a href="#論斷內容-1">命盤分析</a></li>
    <li><a href="#論斷內容-3">本命論斷</a></li>
    <li><a href="#論斷內容-7">傳統論斷</a></li>
    <li><a href="#論斷內容-9">流運分析</a></li>
  </ul>

    <div id="論斷內容-1">
        <div class="命盤分析" id="nrxs-命盤分析">

			<div class="分析單元內容" id="nrxs-基礎分析"></div>

            <div id="nrxs-五行圖表分析" style="height: 350px; width: 400px;margin-top: 0px; margin-bottom: 10px"></div>

            <button id="btn-五行數據" class="btn btn-info" data-toggle="collapse" data-target="#nrxs-五行分析計算表">五行數據</button>
            <div class="collapse 分析單元內容" id="nrxs-五行分析計算表" style="height: auto; width: 100%; margin-top: 20px; float: left;">
                <div id="nrxs-地支力度表"    style="height: auto; width: 300px; margin-top: 12px; float: right;"></div>
                <div id="nrxs-天干力度表"    style="height: auto; width: 300px; margin-top: 12px;"></div>
                <div id="nrxs-合化力度表"></div>
                <div id="nrxs-五行力度總結" style="float: left;"></div>
                <div id="dummy2" style="height: 200px; width: 200px;"></div>
            </div>
            <div id="dummy3" style="height: 10px; width: 580px;"></div>

            <div id="nrxs-五行喜忌表" style="height: auto; width: 98%; margin-top: 20px; float: left;"></div>
            <div id="nrxs-用神喜忌表" style="height: auto; width: 98%; float: left;"></div>
            <div id="nrxs-八字提要與三命日時" style="height: auto; width: 98%; margin-top: 20px; float: left;"></div>

            <button id="btn-五行開運" class="btn btn-info" data-toggle="collapse" data-target="#nrxs-五行開運">五行開運</button>
            <div class="collapse container 分析單元內容" id="nrxs-五行開運" style="height: auto; width: 100%; margin-top: 20px; float: left;"></div>

            <button id="btn-神煞" class="btn btn-info" data-toggle="collapse" data-target="#nrxs-神煞">神煞</button>
            <div class="collapse container 分析單元內容" id="nrxs-神煞" style="height: auto; width: 100%; margin-top: 20px; float: left;"></div>

            <button id="btn-經典參考" class="btn btn-info" data-toggle="collapse" data-target="#nrxs-經典參考">經典參考</button>
            <div class="collapse container 分析單元內容" id="nrxs-經典參考" style="height: auto; width: 100%; margin-top: 20px; float: left;"></div>

            <div id="nrxs-身強弱量規數據 container" style="height: auto; width: 98%; margin-top: 20px;">
                <div class="論斷單元">日主強弱判斷</div>
                <table style="text-align: left; width: 630px; height: 160px; margin-top: 20px; background-color: #ECECEC;" border="0" cellpadding="2" cellspacing="2">
                    <tbody>
                        <tr>
                            <td style="vertical-align: top; width: 220px; text-align: center;">
                                <svg id="身強弱量規" width="98%" height="150"></svg>
                            </td>

                            <td style="vertical-align: top;"><span id="nrxs-身強弱標題" class="身強弱標題">--</span><span id="nrxs-身強弱標題2" class="身強弱標題2">--</span><br>
                                                            <span id="nrxs-身強弱註解" class="身強弱註解"></span></td>
                        </tr>
                    </tbody>
                </table>
            </div>

        
            <div class="分析單元內容" id="nrxs-五行論斷" style="height: auto; width: 100%; margin-top: 20px; float: left;"></div>

            <div id="nrxs-地支分析單元" style="float: left;">
                <div id="nrxs-地支刑冲合害表" style="float: left;"></div>
                <div class="分析單元內容" id="nrxs-地支分析註解" style="float: left;"></div>
            </div>
            
            
		</div>
    </div>

    <div id="論斷內容-3">
        <div id="nrxs-十神圖表分析"style="height: 400px; width: 550px;"></div>

        <!--button id="btn-五行分佈" class="btn btn-info" data-toggle="collapse" data-target="#nrxs-五神圖表分析">五行分佈</button-->
        <div class="分析單元內容" id="nrxs-五神圖表分析" style="height: 400px; width: 400px; margin-top: 20px; float: left;"></div>

        <div class="本命論斷" id="nrxs-本命論斷" style="height: auto; width: 100%; margin-top: 20px; float: left;"></div>
    </div>

    <div id="論斷內容-7">
        <div class="經典參考" id="nrxs-傳統論斷"></div>
    </div>

    <div id="論斷內容-9">
        <div class="流運註解" id="大運註解"></div>
        <br><br>
        <div class="流運註解" id="流年註解"></div>
        <br><br>
        <div class="流運註解" id="流月註解"></div>
    </div>
</div> 

<!--div id="qyang" style="height: auto; width: 100%; margin-top: 20px; float: left;">Quang Yang !!!</div>
<div id="qyin" style="height: auto; width: 100%; margin-top: 20px; float: left;">Quan Yin !!!</div-->
    <!---------------------------------- 經典介紹 ---------------------------------->
        <!-- Scripting Start Here -->
    
    <script>

    var 系統=new 系統初始();
    var 命盤;

        function defaultBazi(InputBazi) {
            document.getElementById("InputNianGan").value = InputBazi.substr(0, 1);
            document.getElementById("InputNianZhi").value = InputBazi.substr(1, 1);
            document.getElementById("InputYueGan").value = InputBazi.substr(2, 1);
            document.getElementById("InputYueZhi").value = InputBazi.substr(3, 1);
            document.getElementById("InputRiGan").value = InputBazi.substr(4, 1);
            document.getElementById("InputRiZhi").value = InputBazi.substr(5, 1);
            document.getElementById("InputShiGan").value = InputBazi.substr(6, 1);
            document.getElementById("InputShiZhi").value = InputBazi.substr(7, 1);
        }

        function defaultInputDate(Year, Month, Day, Hour, Minute, ShiChen) {
            document.getElementById("InputYear").value = Year;
            document.getElementById("InputMonth").value = Month;
            document.getElementById("InputDay").value = Day;
            document.getElementById("InputHour").value = Hour;
            document.getElementById("InputMinute").value = Minute;
            document.getElementById("InputShiChen").value = ShiChen;
        }



        function eUpdateTime(TimeChStr) {
            switch (TimeChStr) {
                case "早子":
                    document.getElementById("InputHour").value = "00";
                    document.getElementById("InputMinute").value = "30";
                    break;
                case "丑":
                    document.getElementById("InputHour").value = "02";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "寅":
                    document.getElementById("InputHour").value = "04";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "卯":
                    document.getElementById("InputHour").value = "06";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "辰":
                    document.getElementById("InputHour").value = "08";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "巳":
                    document.getElementById("InputHour").value = "10";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "午":
                    document.getElementById("InputHour").value = "12";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "未":
                    document.getElementById("InputHour").value = "14";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "申":
                    document.getElementById("InputHour").value = "16";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "酉":
                    document.getElementById("InputHour").value = "18";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "戌":
                    document.getElementById("InputHour").value = "20";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "亥":
                    document.getElementById("InputHour").value = "22";
                    document.getElementById("InputMinute").value = "00";
                    break;
                case "夜子":
                    document.getElementById("InputHour").value = "23";
                    document.getElementById("InputMinute").value = "30";
                    break;
            }
        }

        function eUpdateShiChen(HourTime) {
            var InputHour = Number(HourTime);
            switch (true) {
                case ((InputHour >= 0) && (InputHour < 1)):
                    document.getElementById("InputShiChen").value = "早子";
                    break;
                case ((InputHour >= 1) && (InputHour < 3)):
                    document.getElementById("InputShiChen").value = "丑";
                    break;
                case ((InputHour >= 3) && (InputHour < 5)):
                    document.getElementById("InputShiChen").value = "寅";
                    break;
                case ((InputHour >= 5) && (InputHour < 7)):
                    document.getElementById("InputShiChen").value = "卯";
                    break;
                case ((InputHour >= 7) && (InputHour < 9)):
                    document.getElementById("InputShiChen").value = "辰";
                    break;
                case ((InputHour >= 9) && (InputHour < 11)):
                    document.getElementById("InputShiChen").value = "巳";
                    break;
                case ((InputHour >= 11) && (InputHour < 13)):
                    document.getElementById("InputShiChen").value = "午";
                    break;
                case ((InputHour >= 13) && (InputHour < 15)):
                    document.getElementById("InputShiChen").value = "未";
                    break;
                case ((InputHour >= 15) && (InputHour < 17)):
                    document.getElementById("InputShiChen").value = "申";
                    break;
                case ((InputHour >= 17) && (InputHour < 19)):
                    document.getElementById("InputShiChen").value = "酉";
                    break;
                case ((InputHour >= 19) && (InputHour < 21)):
                    document.getElementById("InputShiChen").value = "戌";
                    break;
                case ((InputHour >= 21) && (InputHour < 23)):
                    document.getElementById("InputShiChen").value = "亥";
                    break;
                case ((InputHour >= 23) && (InputHour < 24)):
                    document.getElementById("InputShiChen").value = "夜子";
                    break;
            }

        }

        function eCalTypeChange(CalType) {
            switch (CalType) {
                case "西曆":
                    //alert("換成西曆");
                    document.getElementById("chkRunMonth").style.visibility = "hidden";
                    document.getElementById("lblLeapMonth").style.visibility = "hidden";
                    document.getElementById("chkRunMonth").checked = false;

                    document.getElementById("lblGanZhiLiFa").style.visibility = "hidden";
                    document.getElementById("lblNianZhu").style.visibility = "hidden";
                    document.getElementById("lblYueZhu").style.visibility = "hidden";
                    document.getElementById("lblRiZhu").style.visibility = "hidden";
                    document.getElementById("lblShiZhu").style.visibility = "hidden";

                    document.getElementById("InputNianGan").style.visibility = "hidden";
                    document.getElementById("InputNianZhi").style.visibility = "hidden";
                    document.getElementById("InputYueGan").style.visibility = "hidden";
                    document.getElementById("InputYueZhi").style.visibility = "hidden";
                    document.getElementById("InputRiGan").style.visibility = "hidden";
                    document.getElementById("InputRiZhi").style.visibility = "hidden";
                    document.getElementById("InputShiGan").style.visibility = "hidden";
                    document.getElementById("InputShiZhi").style.visibility = "hidden";
                    //defaultInputDate("1972", "06", "01", "10", "00", "巳");
                    break;
                case "農曆":
                    document.getElementById("chkRunMonth").style.visibility = 'visible';
                    document.getElementById("lblLeapMonth").style.visibility = "visible";

                    document.getElementById("lblGanZhiLiFa").style.visibility = "hidden";
                    document.getElementById("lblNianZhu").style.visibility = "hidden";
                    document.getElementById("lblYueZhu").style.visibility = "hidden";
                    document.getElementById("lblRiZhu").style.visibility = "hidden";
                    document.getElementById("lblShiZhu").style.visibility = "hidden";

                    document.getElementById("InputNianGan").style.visibility = "hidden";
                    document.getElementById("InputNianZhi").style.visibility = "hidden";
                    document.getElementById("InputYueGan").style.visibility = "hidden";
                    document.getElementById("InputYueZhi").style.visibility = "hidden";
                    document.getElementById("InputRiGan").style.visibility = "hidden";
                    document.getElementById("InputRiZhi").style.visibility = "hidden";
                    document.getElementById("InputShiGan").style.visibility = "hidden";
                    document.getElementById("InputShiZhi").style.visibility = "hidden";

                    //defaultInputDate("1972", "04", "25", "10", "00", "巳");
                    break;
                case "干支曆":
                    document.getElementById("chkRunMonth").style.visibility = "hidden";
                    document.getElementById("lblLeapMonth").style.visibility = "hidden";
                    document.getElementById("chkRunMonth").checked = false;

                    document.getElementById("lblGanZhiLiFa").style.visibility = "visible";
                    document.getElementById("lblNianZhu").style.visibility = "visible";
                    document.getElementById("lblYueZhu").style.visibility = "visible";
                    document.getElementById("lblRiZhu").style.visibility = "visible";
                    document.getElementById("lblShiZhu").style.visibility = "visible";

                    document.getElementById("InputNianGan").style.visibility = "visible";
                    document.getElementById("InputNianZhi").style.visibility = "visible";
                    document.getElementById("InputYueGan").style.visibility = "visible";
                    document.getElementById("InputYueZhi").style.visibility = "visible";
                    document.getElementById("InputRiGan").style.visibility = "visible";
                    document.getElementById("InputRiZhi").style.visibility = "visible";
                    document.getElementById("InputShiGan").style.visibility = "visible";
                    document.getElementById("InputShiZhi").style.visibility = "visible";

                    //defaultBazi("甲子丙子丙子癸巳"); // 干支曆有2個
                    //defaultBazi("乙丑庚辰乙未癸未"); 1925 not valid, but available in 1985, calc was fail
                    break;
            }
        } // end of Calendar change !!

            var 身強弱量規設定 = liquidFillGaugeDefaultSettings();
            身強弱量規設定.circleColor = "#178BCA";
            身強弱量規設定.textColor = "#045681";
            身強弱量規設定.waveTextColor = "#A4DBf8";
            身強弱量規設定.waveColor = "#178BCA";
            身強弱量規設定.waveAnimateTime = 1000;
            //身強弱量規設定.waveRise = false;
            身強弱量規設定.waveRiseTime= 500;
            身強弱量規設定.waveAnimate = true;
            身強弱量規設定.valueCountUp = false;
            身強弱量規設定.circleThickness = 0.1;
            身強弱量規設定.textVertPosition = 0.2;
                        身強弱量規設定.displayPercent = false;

            var 身強弱量規值 = loadLiquidFillGauge("身強弱量規",10, 身強弱量規設定);

        document.getElementById("CalWestern").checked = true;
        eCalTypeChange("西曆");

        function 轉換八字() {
            var CalendarInput = getRadioSelection(document.getElementsByName('InputCal'));
            var YearInput = Number(document.getElementById("InputYear").value);
            var MonthInput = Number(document.getElementById("InputMonth").value);
            var DayInput = Number(document.getElementById("InputDay").value);
            var HourInput = Number(document.getElementById("InputHour").value);
            var MinuteInput = Number(document.getElementById("InputMinute").value);
            var IsLeapMonth = document.getElementById("chkRunMonth").checked;
            var Sex = document.getElementById("InputGender").value;

            switch (CalendarInput) {
                case "西曆":
                    var DateWithTime = document.getElementById("InputDay").value + document.getElementById("InputMonth").value + document.getElementById("InputYear").value + document.getElementById("InputHour").value + document.getElementById("InputMinute").value + "00";
                    var WesternDateWithTime = 日期值轉換(DateWithTime, 1);

                    document.getElementById("BZWesternDate1").innerHTML = "";
                    document.getElementById("BZWesternDate2").innerHTML = "";

                    八字排盤(WesternDateWithTime, Sex);


                    break;
                case "農曆":
                    var NongLiInputDate = document.getElementById("InputYear").value + document.getElementById("InputMonth").value + document.getElementById("InputDay").value + document.getElementById("InputHour").value + document.getElementById("InputMinute").value + "00";
                    var WesternDate = 農曆轉換西曆(NongLiInputDate, IsLeapMonth);
                    var WesternDateWithTime = new Date(WesternDate.valueOf());
                    WesternDateWithTime.setHours(WesternDateWithTime.getHours() + HourInput);
                    WesternDateWithTime.setMinutes(WesternDateWithTime.getMinutes() + MinuteInput);

                    八字排盤(WesternDateWithTime, Sex);


                    break;
                case "干支曆":
                    var GanZhiDate = document.getElementById("InputNianGan").value + document.getElementById("InputNianZhi").value + document.getElementById("InputYueGan").value + document.getElementById("InputYueZhi").value + document.getElementById("InputRiGan").value + document.getElementById("InputRiZhi").value + document.getElementById("InputShiGan").value + document.getElementById("InputShiZhi").value;
                    var WesternDate = 干支曆轉換(GanZhiDate);
                    document.getElementById("BZWesternDate1").innerHTML = "";
                    document.getElementById("BZWesternDate2").innerHTML = "";
                    if (WesternDate != false) {
                        document.getElementById("BZWesternDate1").innerHTML = "八字轉換日期：" + WesternDate[0].西曆中文;
                        if (WesternDate.length == 2) {
                            document.getElementById("BZWesternDate2").innerHTML = "八字轉換日期：" + WesternDate[1].西曆中文;
                            document.getElementById("InputYear").value = WesternDate[1].年;
                            document.getElementById("InputMonth").value = zeroPad(WesternDate[1].月, 2);
                            document.getElementById("InputDay").value = zeroPad(WesternDate[1].日, 2);
                            document.getElementById("InputHour").value = WesternDate[1].時.substr(0, 2);
                            document.getElementById("InputShiChen").value = WesternDate[1].時辰;
                        }
                        else if (WesternDate.length == 1) {
                            //document.getElementById("BZWesternDate2").innerHTML = "日期：" + WesternDate[0].西曆.toDateString();
                            document.getElementById("InputYear").value = WesternDate[0].年;
                            document.getElementById("InputMonth").value = zeroPad(WesternDate[0].月, 2);
                            document.getElementById("InputDay").value = zeroPad(WesternDate[0].日, 2);
                            document.getElementById("InputHour").value = WesternDate[0].時.substr(0, 2);
                            document.getElementById("InputShiChen").value = WesternDate[0].時辰;
                        }
                    }
                    //document.getElementById("WesternDate").innerHTML = " ";
                    //document.getElementById("BaziCalcAns").innerHTML = " ";
                    //document.getElementById("NongliCalcAns").innerHTML = "";
                    //document.getElementById("YinliCalcAns").innerHTML = " ";
                    break;
            }
        }



        function 八字排盤(西曆生日時, 性別) {
            //document.getElementById("content").innerHTML='<object type="text/html" data="home.html" ></object>';
            
            命盤 = new 八字命盤模塊(西曆生日時, 性別);
            if (命盤.系統參數.設定.ChartNull == true) {
                $("#BaziChart").html(GenBaziChart());
                命盤.系統參數.設定.ChartNull = false;
            }
            
            $("#BaziChart").show();
            $("#tabbed-nav").show();

            $(".大運干支格子").eq(命盤.運行.大運數).trigger("click"); // click 現行的大運
            命盤.運行.大運流年數 = 現行大運流年數(命盤.大運[命盤.運行.大運數].起年);
            $(".流年干支格子").eq(命盤.運行.大運流年數).trigger("click"); // click 現行的流年

            var 生日資訊;
            if(命盤.生日.日光節約!="") {
                生日資訊 = 命盤.陽男陰女 + ", " + 命盤.生日.節氣 + ", " + 命盤.生日.日光節約;
            }
            else 生日資訊 = 命盤.陽男陰女 + ", " + 命盤.生日.生肖 + ", " + 命盤.生日.星座 + ", " + 命盤.生日.節氣;

            var 西曆中文=命盤.生日.西曆中文;
            if(命盤.生日.交節日!="") 西曆中文 += "，（交節日）";

            //var 生日資訊 = 命盤.陽男陰女 + ", " + 命盤.生日.生肖 + ", " + 命盤.生日.星座 + ", " + 命盤.生日.節氣;
			//if(命盤.生日.交節日!="") 生日資訊 += "，（交節日）";

            $("#橫幅名稱").html(命盤.系統參數.平台標題);
            $("#版本名稱").html(命盤.系統參數.版本顯示);

            $("#資訊1小題").html(命盤.系統參數.中標題);
            $("#資訊1內容").html(命盤.系統參數.中標題內容);

            $("#mpxs-生日資訊").html(生日資訊);
            $("#mpxs-西曆生日").html(命盤.生日.西曆中文);
            $("#mpxs-農曆生日").html(命盤.生日.農曆);

            var 元男元女 = (命盤.性別 == "男") ? "元男" : "元女";
            $("#mpxs-日元").html(元男元女);

            // *********** 導入 八字干支、藏干 ***********
            $("#mpxs-年干").html(命盤.年干.天干);
            $("#mpxs-年支").html(命盤.年支.地支);

            $("#mpxs-月干").html(命盤.月干.天干);
            $("#mpxs-月支").html(命盤.月支.地支);

            $("#mpxs-日干").html(命盤.日干.天干);
            $("#mpxs-日支").html(命盤.日支.地支);

            $("#mpxs-時干").html(命盤.時干.天干);
            $("#mpxs-時支").html(命盤.時支.地支);

            $("#mpxs-年支藏干1").html(命盤.年支.藏干1);
            $("#mpxs-年支藏干2").html(命盤.年支.藏干2);
            $("#mpxs-年支藏干3").html(命盤.年支.藏干3);

            $("#mpxs-月支藏干1").html(命盤.月支.藏干1);
            $("#mpxs-月支藏干2").html(命盤.月支.藏干2);
            $("#mpxs-月支藏干3").html(命盤.月支.藏干3);

            $("#mpxs-日支藏干1").html(命盤.日支.藏干1);
            $("#mpxs-日支藏干2").html(命盤.日支.藏干2);
            $("#mpxs-日支藏干3").html(命盤.日支.藏干3);

            $("#mpxs-時支藏干1").html(命盤.時支.藏干1);
            $("#mpxs-時支藏干2").html(命盤.時支.藏干2);
            $("#mpxs-時支藏干3").html(命盤.時支.藏干3);

            // *********** 導入 主星、副星 十神 ***********
            $("#mpxs-年干十神").html(命盤.年干.十神);
            $("#mpxs-月干十神").html(命盤.月干.十神);
            $("#mpxs-時干十神").html(命盤.時干.十神);

            $("#mpxs-年副星1").html(命盤.年支.十神1);
            $("#mpxs-年副星2").html(命盤.年支.十神2);
            $("#mpxs-年副星3").html(命盤.年支.十神3);

            $("#mpxs-月副星1").html(命盤.月支.十神1);
            $("#mpxs-月副星2").html(命盤.月支.十神2);
            $("#mpxs-月副星3").html(命盤.月支.十神3);

            $("#mpxs-日副星1").html(命盤.日支.十神1);
            $("#mpxs-日副星2").html(命盤.日支.十神2);
            $("#mpxs-日副星3").html(命盤.日支.十神3);

            $("#mpxs-時副星1").html(命盤.時支.十神1);
            $("#mpxs-時副星2").html(命盤.時支.十神2);
            $("#mpxs-時副星3").html(命盤.時支.十神3);

            // *********** 導入 運星 ***********
            $("#mpxs-年運星").html(命盤.年柱.運星);
            $("#mpxs-月運星").html(命盤.月柱.運星);
            $("#mpxs-日運星").html(命盤.日柱.運星);
            $("#mpxs-時運星").html(命盤.時柱.運星);

             // *********** 導入 納音 ***********
            $("#mpxs-年柱納音").html(命盤.年柱.納音);
            $("#mpxs-月柱納音").html(命盤.月柱.納音);
            $("#mpxs-日柱納音").html(命盤.日柱.納音);
            $("#mpxs-時柱納音").html(命盤.時柱.納音);

            // *********** 導入 神煞 ***********
            $("#mpxs-年柱神煞").html(命盤.神煞.年柱.join("<br>"));
            $("#mpxs-月柱神煞").html(命盤.神煞.月柱.join("<br>"));
            $("#mpxs-日柱神煞").html(命盤.神煞.日柱.join("<br>"));
            $("#mpxs-時柱神煞").html(命盤.神煞.時柱.join("<br>"));

            // ******** 導入 大運干支起歲 ********
            for (var j = 0; j <= 8; j++) {
                $("#mpxs-大運" + j + "干支").html(VerticalString(命盤.大運[j].大運顯示, "大運干支字"));
                $("#mpxs-大運" + j + "起歲").html(命盤.大運[j].起歲);
                $("#mpxs-大運" + j + "起年").html(命盤.大運[j].起年);

                var 大運十神Tooltip = "天干: " + 命盤.大運[j].天干十神 + ", 藏干: " + 命盤.大運[j].地支十神1 + " " + 命盤.大運[j].地支十神2 + " " + 命盤.大運[j].地支十神3;
                $("#mpxs-大運" + j + "干支").prop('title', 大運十神Tooltip);
            }

            // ******** 導入 神煞 ********
            $("#mpxs-年藏干").prop('title', 命盤.神煞.年柱);
            $("#mpxs-月藏干").prop('title', 命盤.神煞.月柱);
            $("#mpxs-日藏干").prop('title', 命盤.神煞.日柱);
            $("#mpxs-時藏干").prop('title', 命盤.神煞.時柱);

            命盤內容建立(命盤);  //本命論斷

            刷新命盤顏色();  //jQueryInitCtrl

            $("#身強弱量規").trigger("click"); // click to refresh liquid fill gauge new value
            //$("#btn-五行開運").trigger("click");

        } //end function 八字排盤



        //alert(十二運星(算子息多寡("壬","未")));

      </script>
        <script type="text/javascript" src="lib\underscore.js"></script> <!---- v1.8.3 ---->
        <script type="text/javascript" src="lib\moment.js"></script> <!---- v2.1 ---->
		<script type="text/javascript" src="lib\canvasjs.min.js"></script>
        <script type="text/javascript" src="script\bzBaseClasses.js"></script>
        <!---script type="text/javascript" src="lib\hammer.js"></script--> <!---- v2.0.4 ---->
       <!--script type="text/javascript" src="lib\moment-timezone.js"></script--> <!---- v2.1 ---->

        <script type="text/javascript" src="script\Plug-ins.js"></script>
        <script type="text/javascript" src="script\八字命盤.js"></script>
        <script type="text/javascript" src="script\命盤分析.js"></script>
		<script type="text/javascript" src="script\五行論斷.js"></script>
        <script type="text/javascript" src="html-code.js"></script>
        <script type="text/javascript" src="script\萬年曆.js"></script>
        <script type="text/javascript" src="script\曆法.js"></script>

        <script type="text/javascript" src="script\神煞.js"></script>
        <script type="text/javascript" src="script\流運計算.js"></script>
        <script type="text/javascript" src="script\十神論斷.js"></script>
        <script type="text/javascript" src="script\本命論斷.js"></script>
        <script type="text/javascript" src="script\傳統論斷.js"></script>
        <script type="text/javascript" src="script\經典參考.js"></script>
        <script type="text/javascript" src="script\造化元鑰.js"></script>
        <script type="text/javascript" src="script\用神喜忌.js"></script>
        <script type="text/javascript" src="script\干支力量分析.js"></script>
        <script type="text/javascript" src="script\刑冲合會害分析.js"></script>
        <script type="text/javascript" src="script\特殊腳本.js"></script>
    </body>
</html>