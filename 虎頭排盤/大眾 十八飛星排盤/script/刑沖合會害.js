function 判斷刑沖合會害(命盤){判斷地支三合(命盤);判斷地支三會(命盤);判斷地支三刑(命盤);};function 半合元件(地支){this.地支=地支;this.成立=false;this.合化="";this.合化天干="";this.合化陰陽="";this.合化註解="";this.三合柱="";this.不參與地支="";this.不參與柱="";};function 判斷地支三合(命盤){var 三合分析=命盤.分析.刑冲合會害.三合;var 地支矩陣=[命盤.年支.地支,命盤.月支.地支,命盤.日支.地支,命盤.時支.地支];var 三合矩陣=["寅午戌","巳酉丑","申子辰","亥卯未"];var 三合五行矩陣=["火","金","水","木"];var 日主陰陽=天干屬性(命盤.日干.天干,"陰陽");var 合出的陰陽=(日主陰陽=="陽")?"陰":"陽";var 合化註解="";for(var i=0;i<三合矩陣.length;i++){var 三合組=三合矩陣[i];var 三合五行=三合五行矩陣[i];var 三合字1=三合組.substr(0,1);var 三合字2=三合組.substr(1,1);var 三合字3=三合組.substr(2,1);if((_.indexOf(地支矩陣,三合字1)>=0)&&(_.indexOf(地支矩陣,三合字2)>=0)&&(_.indexOf(地支矩陣,三合字3)>=0)){var 三合柱1=_.indexOf(地支矩陣,三合字1);var 三合柱2=_.indexOf(地支矩陣,三合字2);var 三合柱3=_.indexOf(地支矩陣,三合字3);var 不參與三合地支=_.without(地支矩陣,三合字1,三合字2,三合字3);var 不參與地支柱=_.indexOf(地支矩陣,String(不參與三合地支));if(不參與地支柱<0){var LastIndex三合柱1=_.lastIndexOf(地支矩陣,三合字1);var LastIndex三合柱2=_.lastIndexOf(地支矩陣,三合字2);var LastIndex三合柱3=_.lastIndexOf(地支矩陣,三合字3);if(LastIndex三合柱1!=三合柱1){var 爭合地支=三合字1;var 爭合柱1=LastIndex三合柱1;var 爭合柱2=三合柱1;if(爭合柱1<爭合柱2){不參與地支柱=爭合柱2;三合柱1=爭合柱1;}else 不參與地支柱=爭合柱1;}if(LastIndex三合柱2!=三合柱2){var 爭合地支=三合字2;var 爭合柱1=LastIndex三合柱2;var 爭合柱2=三合柱2;if(爭合柱1<爭合柱2){不參與地支柱=爭合柱2;三合柱2=爭合柱1;}else{不參與地支柱=爭合柱1;}}if(LastIndex三合柱3!=三合柱3){var 爭合地支=三合字3;var 爭合柱1=LastIndex三合柱3;var 爭合柱2=三合柱3;if(爭合柱1<爭合柱2){不參與地支柱=爭合柱2;三合柱3=爭合柱1;}else 不參與地支柱=爭合柱1;}不參與地支柱= -1;}switch(三合五行){case "火":合化註解="寅午戌合化火，因月令為寅、午、戌、巳，故能合化。";if((命盤.月令!="寅"&&命盤.月令!="午"&&命盤.月令!="戌"&&命盤.月令!="巳")){三合五行="";合化註解="寅午戌合而不化，因為月令不是寅、午、戌、巳月，故不化火。";}break;case "金":合化註解="巳酉丑合化金，因月令為巳、申、酉、丑，故能合化。";if((命盤.月令!="巳"&&命盤.月令!="申"&&命盤.月令!="酉"&&命盤.月令!="丑")){三合五行="";合化註解="巳酉丑合而不化，因為月令不是巳、申、酉、丑月，故不化金。";}break;case "水":合化註解="申子辰合化水，因月令為申、子、辰、亥，故能合化。";if((命盤.月令!="申"&&命盤.月令!="子"&&命盤.月令!="辰"&&命盤.月令!="亥")){三合五行="";合化註解="申子辰合而不化，因為月令不是申、子、辰、亥月，故不化水。";}break;case "木":合化註解="亥卯未合化木，因月令為亥、卯、未、寅，故能合化。";if((命盤.月令!="亥"&&命盤.月令!="卯"&&命盤.月令!="未"&&命盤.月令!="寅")){三合五行="";合化註解="亥卯未合而不化，因為月令不是亥、卯、未、寅月，故不化木。";}break;}命盤.分析.刑冲合會害.三合.成立=true;命盤.分析.刑冲合會害.合數+=3;命盤.分析.刑冲合會害.三合.地支=三合組;命盤.分析.刑冲合會害.三合.合化=三合五行;命盤.分析.刑冲合會害.三合.三合柱=String(三合柱1)+String(三合柱2)+String(三合柱3);命盤.分析.刑冲合會害.三合.合化註解=合化註解;命盤.分析.刑冲合會害.三合.合化天干=五行轉天干(三合五行,合出的陰陽);命盤.分析.刑冲合會害.三合.不參與地支=String(不參與三合地支);命盤.分析.刑冲合會害.三合.不參與柱=不參與地支柱;if(不參與地支柱<0){命盤.分析.刑冲合會害.三合.爭合地支=地支矩陣[爭合柱1];命盤.分析.刑冲合會害.三合.爭合柱=String(爭合柱1)+String(爭合柱2);}else{命盤.分析.刑冲合會害.三合.爭合地支="";命盤.分析.刑冲合會害.三合.爭合地支="";}}}};function 判斷地支三會(命盤){var 地支矩陣=[命盤.年支.地支,命盤.月支.地支,命盤.日支.地支,命盤.時支.地支];var 三會矩陣=["寅卯辰","巳午未","申酉戌","亥子丑"];var 三會五行矩陣=["木","火","金","水"];var 日主陰陽=天干屬性(命盤.日干.天干,"陰陽");var 合出的陰陽=(日主陰陽=="陽")?"陰":"陽";for(var i=0;i<三會矩陣.length;i++){var 三會組=三會矩陣[i];var 三會五行=三會五行矩陣[i];var 三會字1=三會組.substr(0,1);var 三會字2=三會組.substr(1,1);var 三會字3=三會組.substr(2,1);if((_.indexOf(地支矩陣,三會字1)>=0)&&(_.indexOf(地支矩陣,三會字2)>=0)&&(_.indexOf(地支矩陣,三會字3)>=0)){var 三會柱1=_.indexOf(地支矩陣,三會字1);var 三會柱2=_.indexOf(地支矩陣,三會字2);var 三會柱3=_.indexOf(地支矩陣,三會字3);var 不參與三會地支=_.without(地支矩陣,三會字1,三會字2,三會字3);var 不參與地支柱=_.indexOf(地支矩陣,String(不參與三會地支));if(不參與地支柱<0){var LastIndex三會柱1=_.lastIndexOf(地支矩陣,三會字1);var LastIndex三會柱2=_.lastIndexOf(地支矩陣,三會字2);var LastIndex三會柱3=_.lastIndexOf(地支矩陣,三會字3);if(LastIndex三會柱1!=三會柱1){var 爭會地支=三會字1;var 爭會柱1=LastIndex三會柱1;var 爭會柱2=三會柱1;if(爭會柱1<爭會柱2){不參與地支柱=爭會柱2;三會柱1=爭會柱1;}else{不參與地支柱=爭會柱1;}}if(LastIndex三會柱2!=三會柱2){var 爭會地支=三會字2;var 爭會柱1=LastIndex三會柱2;var 爭會柱2=三會柱2;if(爭會柱1<爭會柱2){不參與地支柱=爭會柱2;三會柱2=爭會柱1;}else{不參與地支柱=爭會柱1;}}if(LastIndex三會柱3!=三會柱3){var 爭會地支=三會字3;var 爭會柱1=LastIndex三會柱3;var 爭會柱2=三會柱3;if(爭會柱1<爭會柱2){不參與地支柱=爭會柱2;三會柱3=爭會柱1;}else{不參與地支柱=爭會柱1;}}不參與地支柱= -1;}命盤.分析.刑冲合會害.三會.成立=true;命盤.分析.刑冲合會害.三會.地支=三會組;命盤.分析.刑冲合會害.三會.五行=三會五行;命盤.分析.刑冲合會害.三會.三會柱=String(三會柱1)+String(三會柱2)+String(三會柱3);命盤.分析.刑冲合會害.三會.會化天干=五行轉天干(三會五行,合出的陰陽);命盤.分析.刑冲合會害.三會.不參與地支=String(不參與三會地支);命盤.分析.刑冲合會害.三會.不參與柱=不參與地支柱;}}};function 判斷地支三刑(命盤){var 地支矩陣=[命盤.年支.地支,命盤.月支.地支,命盤.日支.地支,命盤.時支.地支];var 三刑矩陣=["寅巳申","丑戌未"];var 三刑格局=["無恩之刑","恃勢之刑"];for(var i=0;i<三刑矩陣.length;i++){var 三刑組=三刑矩陣[i];var 三刑字1=三刑組.substr(0,1);var 三刑字2=三刑組.substr(1,1);var 三刑字3=三刑組.substr(2,1);if((_.indexOf(地支矩陣,三刑字1)>=0)&&(_.indexOf(地支矩陣,三刑字2)>=0)&&(_.indexOf(地支矩陣,三刑字3)>=0)){var 三刑柱1=_.indexOf(地支矩陣,三刑字1);var 三刑柱2=_.indexOf(地支矩陣,三刑字2);var 三刑柱3=_.indexOf(地支矩陣,三刑字3);var 不參與三刑地支=_.without(地支矩陣,三刑字1,三刑字2,三刑字3);var 不參與地支柱=_.indexOf(地支矩陣,String(不參與三刑地支));if(不參與地支柱<0){var LastIndex三刑柱1=_.lastIndexOf(地支矩陣,三刑字1);var LastIndex三刑柱2=_.lastIndexOf(地支矩陣,三刑字2);var LastIndex三刑柱3=_.lastIndexOf(地支矩陣,三刑字3);if(LastIndex三刑柱1!=三刑柱1){var 爭刑地支=三刑字1;var 爭刑柱1=LastIndex三刑柱1;var 爭刑柱2=三刑柱1;if(爭刑柱1<爭刑柱2){不參與地支柱=爭刑柱2;三刑柱1=爭刑柱1;}else{不參與地支柱=爭刑柱1;}}if(LastIndex三刑柱2!=三刑柱2){var 爭刑地支=三刑字2;var 爭刑柱1=LastIndex三刑柱2;var 爭刑柱2=三刑柱2;if(爭刑柱1<爭刑柱2){不參與地支柱=爭刑柱2;三刑柱2=爭刑柱1;}else{不參與地支柱=爭刑柱1;}}if(LastIndex三刑柱3!=三刑柱3){var 爭刑地支=三刑字3;var 爭刑柱1=LastIndex三刑柱3;var 爭刑柱2=三刑柱3;if(爭刑柱1<爭刑柱2){不參與地支柱=爭刑柱2;三刑柱3=爭刑柱1;}else{不參與地支柱=爭刑柱1;}}不參與地支柱= -1;}命盤.分析.刑冲合會害.三刑.成立=true;命盤.分析.刑冲合會害.刑數+=3;命盤.分析.刑冲合會害.三刑.地支=三刑組;命盤.分析.刑冲合會害.三刑.格局=三刑格局[i];命盤.分析.刑冲合會害.三刑.三刑柱=String(三刑柱1)+String(三刑柱2)+String(三刑柱3);命盤.分析.刑冲合會害.三刑.不參與地支=String(不參與三刑地支);命盤.分析.刑冲合會害.三刑.不參與柱=不參與地支柱;}}};function 地支相刑(地支對,相刑組合){if(地支對.length<2)alert(地支對+"：地支對 錯誤");if(相刑組合.length<2)alert(相刑組合+"：相刑組合 錯誤");var 地支刑="";var 相刑註解="";var 無恩之刑註解="無恩之刑主無人賞識，做事易被人嫌棄，替人打天下，任勞任怨，愛恨交加。";var 恃勢之刑註解="恃勢之刑，太自信，自負，欠考慮，憑感覺判斷。";var 自刑之註解="對自己不滿意，易憂愁，明知不可為而為之，自尊心強，自尋煩惱，容易鬱卒，有話不說，溝通困難。";var 相刑判斷條件={"半刑":false,"自刑":false,"無禮":false};switch(相刑組合){case "所有":相刑判斷條件.半刑=true;相刑判斷條件.自刑=true;相刑判斷條件.無禮=true;break;case "半刑":相刑判斷條件.半刑=true;相刑判斷條件.自刑=false;相刑判斷條件.無禮=false;break;case "自刑":相刑判斷條件.半刑=false;相刑判斷條件.自刑=true;相刑判斷條件.無禮=false;break;case "無禮":相刑判斷條件.半刑=false;相刑判斷條件.自刑=false;相刑判斷條件.無禮=true;break;case "自刑無禮":相刑判斷條件.半刑=false;相刑判斷條件.自刑=true;相刑判斷條件.無禮=true;break;}if(相刑判斷條件.半刑){switch(地支對){case "寅巳":case "巳寅":地支刑="無恩之刑";相刑地支="寅巳";相刑註解=無恩之刑註解;break;case "巳申":case "申巳":地支刑="無恩之刑";相刑地支="巳申";相刑註解=無恩之刑註解;break;case "寅申":case "申寅":地支刑="無恩之刑";相刑地支="寅申";相刑註解=無恩之刑註解;break;case "丑未":case "未丑":地支刑="恃勢之刑";相刑地支="丑未";相刑註解=恃勢之刑註解+"未丑，失敗機率高，看不見卻不斷流失。";break;case "未戌":case "戌未":地支刑="恃勢之刑";相刑地支="未戌";相刑註解=恃勢之刑註解;break;case "丑戌":case "戌丑":地支刑="恃勢之刑";相刑地支="丑戌";相刑註解=恃勢之刑註解;break;default:地支刑="";break;}}if(相刑判斷條件.自刑){switch(地支對){case "辰辰":地支刑="自刑";相刑地支="辰辰";相刑註解=自刑之註解+"辰辰自刑，要別人聽自己，但事與願違而自鬱，請用逆向溝通，先贊同對方，才能得到認同，做事直接，但有遠觀。";break;case "午午":地支刑="自刑";相刑地支="午午";相刑註解=自刑之註解+"午午自刑，常常事與願違，在決定一件事情前，請用逆向溝通方式，先贊同對方，成功率會較高，以禮相待，則好溝通。";break;case "酉酉":地支刑="自刑";相刑地支="酉酉";相刑註解=自刑之註解+"酉酉自刑，常常想幫助別人。但卻得不到認同而鬱卒，常幫倒忙，卻熱心，多慮。";break;case "亥亥":地支刑="自刑";相刑地支="亥亥";相刑註解=自刑之註解+"亥亥自刑，較會無理取鬧、歇斯底里、悲觀，總是想說我比別人認真，為什麼比別人歹命。如又逢流運來害月柱則更加嚴重，喜用頭腦，卻多愁多煩事，易想太多。";break;default:地支刑="";break;}}if(相刑判斷條件.無禮){switch(地支對){case "子卯":case "卯子":地支刑="無禮之刑";相刑地支="子卯";相刑註解="子卯無禮之刑，自命清高，眼角高，說話直接，較沒禮貌，不分尊卑，自以為氣質好";break;default:地支刑="";break;}}var 相刑元件={"成立":false,"地支":相刑地支,"相刑":地支刑,"註解":相刑註解,"備註":""};if(地支刑!="")相刑元件.成立=true;return 相刑元件;};function 判斷地支相刑(命盤,相刑判別){var 地支矩陣=[命盤.年支.地支,命盤.月支.地支,命盤.日支.地支,命盤.時支.地支];var 地支對=[命盤.年支.地支+命盤.日支.地支,命盤.月支.地支+命盤.時支.地支,命盤.年支.地支+命盤.時支.地支,命盤.年支.地支+命盤.月支.地支,命盤.月支.地支+命盤.日支.地支,命盤.日支.地支+命盤.時支.地支];var 相刑條件;var 柱對=["02","13","03","01","12","23"];var 鄰遙刑=["隔刑","隔刑","遙刑","鄰刑","鄰刑","鄰刑"];var 隔離數=[2,2,3,1,1,1];for(var j=0;j<地支對.length;j++){switch(相刑判別){case "所有":相刑條件=地支相刑(地支對[j],"所有");break;case "自刑無禮":相刑條件=地支相刑(地支對[j],"自刑無禮");break;case "自刑":相刑條件=地支相刑(地支對[j],"自刑");break;default:alert("判斷命盤三刑選項錯誤 ！！")}if(相刑條件.成立){var 相刑柱1=Number(相刑條件.地支.substr(0,1));var 相刑柱2=Number(相刑條件.地支.substr(1,1));var 鄰遙爭刑=鄰遙刑[j];if((命盤.分析.四柱.四柱數據[相刑柱1].相刑鄰遙爭=="")&&(命盤.分析.四柱.四柱數據[相刑柱2].相刑鄰遙爭==""))命盤.分析.地支.相刑++;命盤.分析.四柱.四柱數據[相刑柱1].相刑=相刑條件.相刑;命盤.分析.四柱.四柱數據[相刑柱1].相刑鄰遙爭=鄰遙爭刑;命盤.分析.四柱.四柱數據[相刑柱1].相刑數量++;命盤.分析.四柱.四柱數據[相刑柱1].相刑柱=命盤.分析.四柱.四柱數據[相刑柱1].相刑柱+String(相刑柱2);命盤.分析.四柱.四柱數據[相刑柱1].相刑柱間隔=隔離數[j];命盤.分析.四柱.四柱數據[相刑柱1].相刑補充=四柱名稱(相刑柱1)+"與"+四柱名稱(相刑柱2)+相刑條件.地支+相刑條件.相刑;命盤.分析.四柱.四柱數據[相刑柱1].相刑地支=相刑條件.地支;命盤.分析.四柱.四柱數據[相刑柱1].相刑方向=(四柱屬性(命盤,相刑柱1,"地支")==相刑條件.地支.substr(0,1))?1:0;命盤.分析.四柱.四柱數據[相刑柱2].相刑=相刑條件.相刑;命盤.分析.四柱.四柱數據[相刑柱2].相刑鄰遙爭=鄰遙爭刑;命盤.分析.四柱.四柱數據[相刑柱2].相刑數量++;命盤.分析.四柱.四柱數據[相刑柱2].相刑柱=命盤.分析.四柱.四柱數據[相刑柱2].相刑柱+String(相刑柱1);命盤.分析.四柱.四柱數據[相刑柱2].相刑柱間隔=隔離數[j];命盤.分析.四柱.四柱數據[相刑柱2].相刑補充=四柱名稱(相刑柱1)+"與"+四柱名稱(相刑柱2)+相刑條件.地支+相刑條件.相刑;命盤.分析.四柱.四柱數據[相刑柱2].相刑地支=相刑條件.地支;命盤.分析.四柱.四柱數據[相刑柱2].相刑方向=(四柱屬性(命盤,相刑柱2,"地支")==相刑條件.地支.substr(0,1))?1:0;}}var 已推出相刑=[];var 相刑矩陣=[];相刑矩陣[0]="地支相刑";for(var i=0;i<4;i++){if(命盤.分析.四柱.四柱數據[i].相刑數量>1){if(命盤.分析.四柱.四柱數據[i].相刑數量==3){var 爭刑句=四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)))+"、"+四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)))+"、"+四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(2,1)))+"與"+四柱名稱(i)+相刑條件.地支+"形成";if(命盤.分析.四柱.四柱數據[i].相刑方向==1)爭刑句=爭刑句+"一支刑三支的"+相刑條件.相刑+"。";if(命盤.分析.四柱.四柱數據[i].相刑方向==0)爭刑句=爭刑句+"三支刑一支的"+相刑條件.相刑+"。";命盤.分析.四柱.四柱數據[i].相刑補充=爭刑句;命盤.分析.四柱.四柱數據[Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1))].相刑鄰遙爭="爭刑";命盤.分析.四柱.四柱數據[Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1))].相刑鄰遙爭="爭刑";命盤.分析.四柱.四柱數據[Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(2,1))].相刑鄰遙爭="爭刑";已推出相刑.push(i);已推出相刑.push(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)));已推出相刑.push(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)));已推出相刑.push(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(2,1)));相刑矩陣[四柱位置重組(i,1)]=相刑條件.相刑;相刑矩陣[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)),1)]=相刑條件.相刑+"*";相刑矩陣[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)),1)]=相刑條件.相刑+"*";相刑矩陣[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(2,1)),1)]=相刑條件.相刑+"*";相刑矩陣[5]=命盤.分析.四柱.四柱數據[i].相刑補充;命盤.分析句.刑冲合會害矩陣.push(相刑矩陣);相刑表[1]="相刑";相刑表[2]=命盤.分析.四柱.四柱數據[i].相刑地支;相刑表[3]="";相刑表[4]="";相刑表[5]="";相刑表[6]=0;相刑表[7]=i+命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)+","+i+命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)+","+i+命盤.分析.四柱.四柱數據[i].相刑柱.substr(2,1);相刑表[8]=1;相刑表[9]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[10]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[11]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[12]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[13]=1;相刑表[14]=1;相刑表[15]=相刑表[2]+"相刑（1對3）";相刑表[16]="相刑";命盤.分析.刑冲合會害表.push(相刑表);命盤.分析.四柱.相刑=5;}if((命盤.分析.四柱.四柱數據[i].相刑數量==2)&&(_.indexOf(已推出相刑,i)== -1)){if(命盤.分析.四柱.四柱數據[0].相刑數量==2&&命盤.分析.四柱.四柱數據[1].相刑數量==2&&命盤.分析.四柱.四柱數據[2].相刑數量==2&&命盤.分析.四柱.四柱數據[3].相刑數量==2){已推出相刑.push(0);已推出相刑.push(1);已推出相刑.push(2);已推出相刑.push(3);var 刑支1=命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1);var 刑支2=命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1);var 爭刑句="四柱形成兩組"+相刑條件.地支+相刑條件.相刑+"。";相刑矩陣[1]=相刑條件.相刑;相刑矩陣[2]=相刑條件.相刑;相刑矩陣[3]=相刑條件.相刑;相刑矩陣[4]=相刑條件.相刑;相刑矩陣[5]=爭刑句;命盤.分析句.刑冲合會害矩陣.push(相刑矩陣);var 克應柱對;switch(命盤.分析.四柱.四柱數據[i].相刑柱){case "01":case "10":case "23":case "32":克應柱對="12,13,02,03";break;case "12":case "21":case "03":case "30":克應柱對="01,23,02,13";break;case "02":case "20":case "13":case "31":克應柱對="01,23,12,03";break;}相刑表[1]="相刑";相刑表[2]=命盤.分析.四柱.四柱數據[i].相刑地支;相刑表[3]="";相刑表[4]="";相刑表[5]="";相刑表[6]=0;相刑表[7]=克應柱對;相刑表[8]=1;相刑表[9]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[10]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[11]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[12]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/4;相刑表[13]=1;相刑表[14]=1;相刑表[15]=相刑表[2]+"相刑（2組）";相刑表[16]="相刑";命盤.分析.刑冲合會害表.push(相刑表);命盤.分析.四柱.相刑=4;}else{var 爭刑句1=四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)))+"、"+四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)))+"與"+四柱名稱(i)+"形成"+相刑條件.地支+相刑條件.相刑+"。";if(命盤.分析.四柱.四柱數據[i].相刑方向==1)var 爭刑句2=四柱名稱(i)+"一支刑二支。";if(命盤.分析.四柱.四柱數據[i].相刑方向==0)var 爭刑句2=四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)))+"與"+四柱名稱(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)))+"二支刑一支。";命盤.分析.四柱.四柱數據[i].相刑補充=爭刑句1+爭刑句2;命盤.分析.四柱.四柱數據[Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1))].相刑鄰遙爭="爭刑";命盤.分析.四柱.四柱數據[Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1))].相刑鄰遙爭="爭刑";已推出相刑.push(i);已推出相刑.push(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)));已推出相刑.push(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)));相刑矩陣[四柱位置重組(i,1)]=相刑條件.相刑;相刑矩陣[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)),1)]=相刑條件.相刑+"*";相刑矩陣[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)),1)]=相刑條件.相刑+"*";var 四柱=[0,1,2,3];var 不參與矩陣=_.without(四柱,i,Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)),Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1)));var 不參與柱=不參與矩陣[0];命盤.分析.四柱.四柱數據[i].相刑柱不參與=String(不參與柱);相刑矩陣[四柱位置重組(不參與柱,1)]="";相刑矩陣[5]=命盤.分析.四柱.四柱數據[i].相刑補充;命盤.分析句.刑冲合會害矩陣.push(相刑矩陣);var 克應地支=i+命盤.分析.四柱.四柱數據[i].相刑柱;相刑表[1]="相刑";相刑表[2]=命盤.分析.四柱.四柱數據[i].相刑地支;相刑表[3]="";相刑表[4]="";相刑表[5]="";相刑表[6]=0;相刑表[7]=i+命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)+","+i+命盤.分析.四柱.四柱數據[i].相刑柱.substr(1,1);相刑表[8]=1;相刑表[四柱位置重組(Number(克應地支.substr(0,1)),offsetTblCalc)]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/3;相刑表[四柱位置重組(Number(克應地支.substr(1,1)),offsetTblCalc)]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/3;相刑表[四柱位置重組(Number(克應地支.substr(2,1)),offsetTblCalc)]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/3;相刑表[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱不參與.substr(0,1)),offsetTblCalc)]=0;相刑表[13]=1;相刑表[14]=1;相刑表[15]=相刑表[2]+"相刑（爭）";相刑表[16]="相刑";命盤.分析.刑冲合會害表.push(相刑表);命盤.分析.四柱.相刑=3;}}}}for(var i=0;i<4;i++){if((命盤.分析.四柱.四柱數據[i].相刑數量==1)&&(_.indexOf(已推出相刑,i)== -1)){var 相刑矩陣=[];相刑矩陣[0]="地支相刑";var 相刑表=[];相刑表[0]="地支";相刑矩陣[四柱位置重組(i,1)]=命盤.分析.四柱.四柱數據[i].相刑;相刑矩陣[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)),1)]=命盤.分析.四柱.四柱數據[Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1))].相刑;已推出相刑.push(i);已推出相刑.push(Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)));var 四柱=[0,1,2,3];var 不參與矩陣=_.without(四柱,i,Number(命盤.分析.四柱.四柱數據[i].相刑柱.substr(0,1)));var 不參與柱1=不參與矩陣[0];var 不參與柱2=不參與矩陣[1];命盤.分析.四柱.四柱數據[i].相刑柱不參與=String(不參與柱1)+String(不參與柱2);相刑矩陣[四柱位置重組(不參與柱1,1)]="";相刑矩陣[四柱位置重組(不參與柱2,1)]="";相刑矩陣[5]=命盤.分析.四柱.四柱數據[i].相刑補充;命盤.分析句.刑冲合會害矩陣.push(相刑矩陣);相刑表[1]="相刑";相刑表[2]=命盤.分析.四柱.四柱數據[i].相刑地支;相刑表[3]="";相刑表[4]="";相刑表[5]="";相刑表[6]=0;相刑表[7]=i+命盤.分析.四柱.四柱數據[i].相刑柱;相刑表[8]=命盤.分析.四柱.四柱數據[i].相刑柱間隔;相刑表[四柱位置重組(Number(相刑表[7].substr(0,1)),offsetTblCalc)]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/(2*Number(相刑表[8]));相刑表[四柱位置重組(Number(相刑表[7].substr(1,1)),offsetTblCalc)]=(-1)*parseFloat(命盤.系統參數.運算.地支相刑)/(2*Number(相刑表[8]));相刑表[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱不參與.substr(0,1)),offsetTblCalc)]=0;相刑表[四柱位置重組(Number(命盤.分析.四柱.四柱數據[i].相刑柱不參與.substr(1,1)),offsetTblCalc)]=0;相刑表[13]=1;相刑表[14]=0;相刑表[15]=相刑表[2]+"相刑";相刑表[16]="相刑";命盤.分析.刑冲合會害表.push(相刑表);命盤.分析.四柱.相刑=命盤.分析.四柱.相刑+1;}}}