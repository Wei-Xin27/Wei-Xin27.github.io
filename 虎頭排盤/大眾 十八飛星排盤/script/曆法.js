function 西曆轉換(輸入西曆日期){var 運算的西曆=new Date(輸入西曆日期);var 曆法數據=萬年曆();var 西曆年,西曆月,西曆日,西曆時,西曆分;var 干支年,干支月,干支日,干支時;var 節,節日期,距離節的天數,節氣,節氣時段,節氣數,下個節氣日期,上個節氣日期,下個節氣時差,上個節氣時差,當天是交節日,本季交節日,本季末日,時支;西曆年=運算的西曆.getFullYear();西曆月=運算的西曆.getMonth();西曆日=運算的西曆.getDate();西曆時=運算的西曆.getHours();西曆分=運算的西曆.getMinutes();西曆秒=運算的西曆.getSeconds();var YearData=西曆年-1923;var 立春年數=曆法數據[YearData].立春年干支數;var 立春月數=曆法數據[YearData].立春月干支數;var 立春日數=曆法數據[YearData].立春日干支數;var 輸入日期=new Date(輸入西曆日期.getFullYear(),輸入西曆日期.getMonth(),輸入西曆日期.getDate(),0,0,0,0);var 輸入時間=輸入西曆日期.getHours()+":"+輸入西曆日期.getMinutes()+":"+"00";var 立春日期=日曆值轉換(曆法數據[YearData].立春,2);var 距離立春日=momentDateDiff(輸入日期,立春日期);當天是交節日=false;if(運算的西曆<日曆值轉換(曆法數據[YearData].小寒,1)){節氣="冬至";節氣數=21;節氣時段="冬至後，小寒前";節="大雪";節日期=日曆值轉換(曆法數據[YearData-1].大雪,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].小寒,1);上個節氣日期=日曆值轉換(曆法數據[YearData-1].大雪,1);本季末日=日曆值轉換(曆法數據[YearData].小寒,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=(輸入日期.valueOf()==本季交節日.valueOf())?true:false;干支年=干支滾動(立春年數,-1);干支月=干支滾動(立春月數,-2);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].小寒,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].大寒,1))){節氣="小寒";節氣數=22;節氣時段="小寒後，大寒前";節="小寒";節日期=日曆值轉換(曆法數據[YearData].小寒,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立春,1);上個節氣日期=日曆值轉換(曆法數據[YearData].小寒,1);本季末日=日曆值轉換(曆法數據[YearData].大寒,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,-1);干支月=干支滾動(立春月數,-1);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].大寒,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].立春,1))){節氣="大寒";節氣數=23;節氣時段="大寒後，立春前";節="小寒";節日期=日曆值轉換(曆法數據[YearData].小寒,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立春,1);上個節氣日期=日曆值轉換(曆法數據[YearData].小寒,1);本季末日=日曆值轉換(曆法數據[YearData].立春,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,-1);干支月=干支滾動(立春月數,-1);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].立春,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].雨水,1))){節氣="立春";節氣數=0;節氣時段="立春後，雨水前";節="立春";節日期=日曆值轉換(曆法數據[YearData].立春,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].驚蟄,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立春,1);本季末日=日曆值轉換(曆法數據[YearData].雨水,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,0);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].雨水,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].驚蟄,1))){節氣="雨水";節氣數=1;節氣時段="雨水後，驚蟄前";節="立春";節日期=日曆值轉換(曆法數據[YearData].立春,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].驚蟄,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立春,1);本季末日=日曆值轉換(曆法數據[YearData].驚蟄,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,0);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].驚蟄,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].春分,1))){節氣="驚蟄";節氣數=2;節氣時段="驚蟄後，春分前";節="驚蟄";節日期=日曆值轉換(曆法數據[YearData].驚蟄,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].清明,1);上個節氣日期=日曆值轉換(曆法數據[YearData].驚蟄,1);本季末日=日曆值轉換(曆法數據[YearData].春分,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,1);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].春分,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].清明,1))){節氣="春分";節氣數=3;節氣時段="春分後，清明前";節="驚蟄";節日期=日曆值轉換(曆法數據[YearData].驚蟄,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].清明,1);上個節氣日期=日曆值轉換(曆法數據[YearData].驚蟄,1);本季末日=日曆值轉換(曆法數據[YearData].清明,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,1);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].清明,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].穀雨,1))){節氣="清明";節氣數=4;節氣時段="清明後，穀雨前";節="清明";節日期=日曆值轉換(曆法數據[YearData].清明,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立夏,1);上個節氣日期=日曆值轉換(曆法數據[YearData].清明,1);本季末日=日曆值轉換(曆法數據[YearData].穀雨,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,2);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].穀雨,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].立夏,1))){節氣="穀雨";節氣數=5;節氣時段="穀雨後，立夏前";節="清明";節日期=日曆值轉換(曆法數據[YearData].清明,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立夏,1);上個節氣日期=日曆值轉換(曆法數據[YearData].清明,1);本季末日=日曆值轉換(曆法數據[YearData].立夏,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,2);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].立夏,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].小滿,1))){節氣="立夏";節氣數=6;節氣時段="立夏後，小滿前";節="立夏";節日期=日曆值轉換(曆法數據[YearData].立夏,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].芒種,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立夏,1);本季末日=日曆值轉換(曆法數據[YearData].小滿,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,3);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].小滿,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].芒種,1))){節氣="小滿";節氣數=7;節氣時段="小滿後，芒種前";節="立夏";節日期=日曆值轉換(曆法數據[YearData].立夏,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].芒種,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立夏,1);本季末日=日曆值轉換(曆法數據[YearData].芒種,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,3);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].芒種,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].夏至,1))){節氣="芒種";節氣數=8;節氣時段="芒種後，夏至前";節="芒種";節日期=日曆值轉換(曆法數據[YearData].芒種,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].小暑,1);上個節氣日期=日曆值轉換(曆法數據[YearData].芒種,1);本季末日=日曆值轉換(曆法數據[YearData].夏至,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,4);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].夏至,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].小暑,1))){節氣="夏至";節氣數=9;節氣時段="夏至後，小暑前";節="芒種";節日期=日曆值轉換(曆法數據[YearData].芒種,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].小暑,1);上個節氣日期=日曆值轉換(曆法數據[YearData].芒種,1);本季末日=日曆值轉換(曆法數據[YearData].小暑,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,4);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].小暑,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].大暑,1))){節氣="小暑";節氣數=10;節氣時段="小暑後，大暑前";節="小暑";節日期=日曆值轉換(曆法數據[YearData].小暑,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立秋,1);上個節氣日期=日曆值轉換(曆法數據[YearData].小暑,1);本季末日=日曆值轉換(曆法數據[YearData].大暑,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,5);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].大暑,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].立秋,1))){節氣="大暑";節氣數=11;節氣時段="大暑後，立秋前";節="小暑";節日期=日曆值轉換(曆法數據[YearData].小暑,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立秋,1);上個節氣日期=日曆值轉換(曆法數據[YearData].小暑,1);本季末日=日曆值轉換(曆法數據[YearData].立秋,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,5);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].立秋,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].處暑,1))){節氣="立秋";節氣數=12;節氣時段="立秋後，處暑前";節="立秋";節日期=日曆值轉換(曆法數據[YearData].立秋,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].白露,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立秋,1);本季末日=日曆值轉換(曆法數據[YearData].處暑,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,6);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].處暑,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].白露,1))){節氣="處暑";節氣數=13;節氣時段="處暑後，白露前";節="立秋";節日期=日曆值轉換(曆法數據[YearData].立秋,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].白露,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立秋,1);本季末日=日曆值轉換(曆法數據[YearData].白露,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,6);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].白露,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].秋分,1))){節氣="白露";節氣數=14;節氣時段="白露後，秋分前";節="白露";節日期=日曆值轉換(曆法數據[YearData].白露,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].寒露,1);上個節氣日期=日曆值轉換(曆法數據[YearData].白露,1);本季末日=日曆值轉換(曆法數據[YearData].秋分,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,7);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].秋分,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].寒露,1))){節氣="秋分";節氣數=15;節氣時段="秋分後，寒露前";節="白露";節日期=日曆值轉換(曆法數據[YearData].白露,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].寒露,1);上個節氣日期=日曆值轉換(曆法數據[YearData].白露,1);本季末日=日曆值轉換(曆法數據[YearData].寒露,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,7);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].寒露,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].霜降,1))){節氣="寒露";節氣數=16;節氣時段="寒露後，霜降前";節="寒露";節日期=日曆值轉換(曆法數據[YearData].寒露,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立冬,1);上個節氣日期=日曆值轉換(曆法數據[YearData].寒露,1);本季末日=日曆值轉換(曆法數據[YearData].霜降,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,8);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].霜降,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].立冬,1))){節氣="霜降";節氣數=17;節氣時段="霜降後，立冬前";節="寒露";節日期=日曆值轉換(曆法數據[YearData].寒露,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].立冬,1);上個節氣日期=日曆值轉換(曆法數據[YearData].寒露,1);本季末日=日曆值轉換(曆法數據[YearData].立冬,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,8);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].立冬,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].小雪,1))){節氣="立冬";節氣數=18;節氣時段="立冬後，小雪前";節="立冬";節日期=日曆值轉換(曆法數據[YearData].立冬,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].大雪,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立冬,1);本季末日=日曆值轉換(曆法數據[YearData].小雪,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,9);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].小雪,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].大雪,1))){節氣="小雪";節氣數=19;節氣時段="小雪後，大雪前";節="立冬";節日期=日曆值轉換(曆法數據[YearData].立冬,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData].大雪,1);上個節氣日期=日曆值轉換(曆法數據[YearData].立冬,1);本季末日=日曆值轉換(曆法數據[YearData].大雪,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,9);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].大雪,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData].冬至,1))){節氣="大雪";節氣數=20;節氣時段="大雪後，冬至前";節="大雪";節日期=日曆值轉換(曆法數據[YearData].大雪,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData+1].小寒,1);上個節氣日期=日曆值轉換(曆法數據[YearData].大雪,1);本季末日=日曆值轉換(曆法數據[YearData].冬至,1);本季交節日=new Date(上個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,10);干支日=干支滾動(立春日數,距離立春日);}else if((運算的西曆>=日曆值轉換(曆法數據[YearData].冬至,1))&&(運算的西曆<日曆值轉換(曆法數據[YearData+1].小寒,1))){節氣="冬至";節氣數=21;節氣時段="冬至後，小寒前";節="大雪";節日期=日曆值轉換(曆法數據[YearData].大雪,1);距離節的天數=momentDateDiff(運算的西曆,節日期);下個節氣日期=日曆值轉換(曆法數據[YearData+1].小寒,1);上個節氣日期=日曆值轉換(曆法數據[YearData].大雪,1);本季末日=日曆值轉換(曆法數據[YearData+1].小寒,1);本季交節日=new Date(下個節氣日期);本季交節日.setHours(0,0,0,0);當天是交節日=輸入日期.valueOf()==本季交節日.valueOf()?true:false;干支年=干支滾動(立春年數,0);干支月=干支滾動(立春月數,10);干支日=干支滾動(立春日數,距離立春日);}時支=時間轉換地支(輸入時間,1);時柱=時柱判斷(六十干支屬性(干支日,1).substr(0,1),時支);干支時=六十干支字轉值(時柱);if(Number(西曆秒)==1){時支="-";時柱="--";干支時="--";}var 干支曆數據=[];var 干支曆=六十干支屬性(干支年,1)+六十干支屬性(干支月,1)+六十干支屬性(干支日,1)+時柱;var 交節日字串=當天是交節日?"（交節日）":"";var 生肖=地支字轉生肖(六十干支屬性(干支年,1).substr(1,1));干支曆數據=[干支曆,干支年,干支月,干支日,干支時,生肖,節氣,交節日字串,上個節氣日期,下個節氣日期,節,節日期,距離節的天數,節氣數];var 干支曆={"日期":干支曆,"年干支數":干支年,"月干支數":干支月,"日干支數":干支日,"時干支數":干支時,"生肖":生肖,"節氣":節氣,"節氣數":節氣數,"上個節氣日期":上個節氣日期,"下個節氣日期":下個節氣日期,"節":節,"節日期":節日期,"距離節的天數":距離節的天數,"交節":交節日字串};function 農曆計算(計算的西曆,計算年份數據){距離初一天數=momentDateDiff(計算的西曆,正月初一日期);閏月字串="";算出月=1;算出日=1;DayCounter=0;當月天數=29+Number(曆法數據[計算年份數據].大小月.substr(算出月-1,1));while(DayCounter<距離初一天數){if(算出日<當月天數){算出日+=1;}else if(算出月==曆法數據[計算年份數據].閏月){算出日=1;當月天數=曆法數據[計算年份數據].閏月天數;閏月字串="（閏）";DayCounter+=1;while(DayCounter<距離初一天數&&算出日<當月天數){DayCounter+=1;算出日+=1;}if(DayCounter<距離初一天數){算出月+=1;算出日=1;當月天數=29+Number(曆法數據[計算年份數據].大小月.substr(算出月-1,1));閏月字串="";}}else{算出月+=1;算出日=1;當月天數=29+Number(曆法數據[計算年份數據].大小月.substr(算出月-1,1));}DayCounter+=1;}算出年=計算年份數據+1923;var 計算結果=[];計算結果=[算出年,算出月,算出日,閏月字串];return 計算結果;};var 算出年,算出月,算出日,距離初一天數,閏月字串,當月天數,DayCounter;var 農曆計算年份=輸入日期.valueOf()>=日曆值轉換(曆法數據[YearData].初一西曆,2).valueOf()?YearData:YearData-1;var 正月初一日期=日曆值轉換(曆法數據[農曆計算年份].初一西曆,2);var 農曆計算結果=農曆計算(輸入日期,農曆計算年份);var 農曆年=農曆計算結果[0];var 農曆月=農曆計算結果[1];var 農曆日=農曆計算結果[2];var 農曆閏月字=農曆計算結果[3];var 農曆時;if(時支=="-")農曆時="";else 農曆時=時支+"時";var 農曆日期=農曆年+"（"+六十干支屬性(干支年,1)+"）年"+農曆閏月字+農曆月+"月"+農曆日+"日"+農曆時;var 農曆數據=[日曆值轉換(曆法數據[YearData].立春,1)];var 中氣日期,命宮生月數;switch(農曆月){case 1:中氣日期=日曆值轉換(曆法數據[YearData].雨水,1);中氣日期.setDate(中氣日期.getDate()+5);命宮生月數=(運算的西曆>=中氣日期)?2:1;break;case 2:中氣日期=日曆值轉換(曆法數據[YearData].春分,1);中氣日期.setDate(中氣日期.getDate()+7);命宮生月數=(運算的西曆>=中氣日期)?3:2;break;case 3:中氣日期=日曆值轉換(曆法數據[YearData].穀雨,1);中氣日期.setDate(中氣日期.getDate()+9);命宮生月數=(運算的西曆>=中氣日期)?4:3;break;case 4:中氣日期=日曆值轉換(曆法數據[YearData].小滿,1);中氣日期.setDate(中氣日期.getDate()+10);命宮生月數=(運算的西曆>=中氣日期)?5:4;break;case 5:中氣日期=日曆值轉換(曆法數據[YearData].夏至,1);中氣日期.setDate(中氣日期.getDate()+9);命宮生月數=(運算的西曆>=中氣日期)?6:5;break;case 6:中氣日期=日曆值轉換(曆法數據[YearData].大暑,1);中氣日期.setDate(中氣日期.getDate()+8);命宮生月數=(運算的西曆>=中氣日期)?7:6;break;case 7:中氣日期=日曆值轉換(曆法數據[YearData].處暑,1);中氣日期.setDate(中氣日期.getDate()+9);命宮生月數=(運算的西曆>=中氣日期)?8:7;break;case 8:中氣日期=日曆值轉換(曆法數據[YearData].秋分,1);中氣日期.setDate(中氣日期.getDate()+11);命宮生月數=(運算的西曆>=中氣日期)?9:8;break;case 9:中氣日期=日曆值轉換(曆法數據[YearData].霜降,1);中氣日期.setDate(中氣日期.getDate()+13);命宮生月數=(運算的西曆>=中氣日期)?10:9;break;case 10:中氣日期=日曆值轉換(曆法數據[YearData].小雪,1);中氣日期.setDate(中氣日期.getDate()+12);命宮生月數=(運算的西曆>=中氣日期)?11:10;break;case 11:中氣日期=日曆值轉換(曆法數據[YearData].冬至,1);中氣日期.setDate(中氣日期.getDate()+8);命宮生月數=(運算的西曆>=中氣日期)?12:11;break;case 12:中氣日期=日曆值轉換(曆法數據[YearData+1].大寒,1);中氣日期.setDate(中氣日期.getDate()+5);命宮生月數=(運算的西曆>=中氣日期)?1:12;break;}農曆數據=[農曆日期,農曆年,農曆月,農曆日,時支,農曆閏月字,六十干支屬性(干支年,1),命宮生月數];var 農曆={"日期":農曆日期,"年":農曆年,"月":農曆月,"日":農曆日,"時支":時支,"閏月":農曆閏月字,"干支年":六十干支屬性(干支年,1),"命宮生月":命宮生月數};var 陰曆輸入日期,陰曆干支年,陰曆月,陰曆日,陰曆時支;陰曆輸入日期=new Date(輸入日期.valueOf());陰曆干支年=干支年;陰曆時支=時支;if(陰曆時支=="早子"){陰曆時支="子";}if(陰曆時支=="夜子"){陰曆輸入日期.setDate(陰曆輸入日期.getDate()+1);陰曆時支="子";}var NLYearData=陰曆輸入日期.getFullYear()-1923;var 陰曆計算年份=陰曆輸入日期.valueOf()>=日曆值轉換(曆法數據[NLYearData].初一西曆,2).valueOf()?NLYearData:NLYearData-1;var 正月初一日期=日曆值轉換(曆法數據[陰曆計算年份].初一西曆,2);var 陰曆計算結果=農曆計算(陰曆輸入日期,陰曆計算年份);var 陰曆年=陰曆計算結果[0];var 陰曆月=陰曆計算結果[1];var 陰曆日=陰曆計算結果[2];var 陰曆閏月字=陰曆計算結果[3];if(陰曆月==12){陰曆干支年=干支滾動(陰曆干支年,-1);}var 陰時;if(陰曆時支=="-")陰時="";else 陰時=陰曆時支+"時";var 陰曆日期=六十干支屬性(陰曆干支年,1)+"年"+陰曆閏月字+陰曆月+"月"+陰曆日+"日"+陰時;var 陰曆數據=[];陰曆數據=[陰曆日期,陰曆年,陰曆月,陰曆日,陰曆時支,陰曆閏月字,六十干支屬性(陰曆干支年,1)];var 陰曆={"日期":陰曆日期,"年":陰曆年,"月":陰曆月,"日":陰曆日,"時支":陰曆時支,"閏月":陰曆閏月字,"干支年":六十干支屬性(陰曆干支年,1)};var 輸出曆法數據=[];輸出曆法數據=[干支曆數據,農曆數據,陰曆數據];var 曆法={"干支曆":干支曆,"農曆":農曆,"陰曆":陰曆};return 曆法;};function 干支曆轉換(輸入干支日期){var 曆法數據=萬年曆();var 干支日期=輸入干支日期.substr(0,6);console.log(輸入干支日期);var 干支日期=干支日期.substr(0,6);var 年柱=干支日期.substr(0,2);var 年柱數=六十干支字轉值(年柱);var 月柱=干支日期.substr(2,2);var 月支=干支日期.substr(3,1);var 日柱=干支日期.substr(4,2);var 日干=日柱.substr(0,1);var 日柱數=六十干支字轉值(日柱);var ArrayCounter=0;var 時支=輸入干支日期.substr(7,1);var 時柱=輸入干支日期.substr(6,2);var EvaluatedTime;if(isNaN(年柱數)){alert("輸入年柱干支錯誤！！");干支輸入正確=false;return 干支輸入正確;}if(isNaN(日柱數)){alert("輸入日柱干支錯誤！！");干支輸入正確=false;return 干支輸入正確;}var 西曆年份=1923+年柱數;console.log(西曆年份+月支);var 日期矩陣=[];for(var i=0;西曆年份<=new Date().getFullYear()+3;i++){var 節氣日期=年月支尋節氣日期(西曆年份,月支);var 節氣曆法數據=西曆轉換(節氣日期);console.log(節氣曆法數據);var 節氣干支曆=節氣曆法數據.干支曆.日期;var 節氣月柱=節氣干支曆.substr(2,2);var 節氣日柱=節氣干支曆.substr(4,2);var 節氣日柱數=六十干支字轉值(節氣日柱);var 是否交節日=干支日期==節氣干支曆.substr(0,6)?true:false;var 交節時=節氣干支曆.substr(7,1)+"時";var 干支輸入正確=true;if(月柱!=節氣月柱){alert("輸入月柱干支錯誤，"+西曆年份+"，"+年柱+"年，"+月支+"月的干支是"+節氣月柱);干支輸入正確=false;}var 日差數=日柱數-節氣日柱數>=0?日柱數-節氣日柱數:日柱數-節氣日柱數+60;var 預算日期=new Date(節氣日期.valueOf());預算日期.setDate(預算日期.getDate()+日差數);預算日期.setMinutes(預算日期.getMinutes()+1);var 預算日期數據=西曆轉換(預算日期);var 預算日期干支曆=預算日期數據.干支曆.日期;if(干支日期!=預算日期干支曆.substr(0,6)){干支輸入正確=false;預算日期=null;}if(干支輸入正確){if(時支!="子"){var 預算時柱=時柱判斷(日干,時支);if(預算時柱==時柱){EvaluatedTime=地支字轉換時數(時支);}else{alert("輸入的時柱不正確，"+年柱+月柱+日柱+"，"+時支+"時的時柱是"+預算時柱);干支輸入正確=false;}}else if(時支=="子"){var 預算早子時柱=時柱判斷(日干,"早子");var 預算夜子時柱=時柱判斷(日干,"夜子");switch(true){case(預算早子時柱==時柱):EvaluatedTime=地支字轉換時數("早子");break;case(預算夜子時柱==時柱):EvaluatedTime=地支字轉換時數("夜子");break;case((預算早子時柱!=時柱)&&(預算夜子時柱!=時柱)):alert("輸入的時柱不正確，"+年柱+月柱+日柱+"，"+時支+"時的時柱是"+預算早子時柱+"或"+預算夜子時柱);干支輸入正確=false;break;}}}if(干支輸入正確){var 預算西曆=new Date(預算日期.getFullYear(),預算日期.getMonth(),預算日期.getDate(),EvaluatedTime,0,0,0);var 預算終檢=西曆轉換(預算西曆);var 預算終檢干支曆=預算終檢.干支曆.日期;var 西曆時數=zeroPad(EvaluatedTime,2)+":00:00";if(預算終檢干支曆==輸入干支日期){日期矩陣[ArrayCounter]=new 西曆日期模塊(預算日期.getFullYear(),預算西曆.getMonth()+1,預算西曆.getDate(),西曆時數);ArrayCounter+=1;}else{var ValidationStr="\n 輸入八字："+輸入干支日期+"\n 逆算八字："+預算終檢干支曆;if(是否交節日){var ValidationJiaoJie="\n 輸入的八字當天為交節日，交節時為"+交節時;alert(" 留意輸入的八字，"+ValidationJiaoJie+ValidationStr);日期矩陣[ArrayCounter]=new 西曆日期模塊(預算日期.getFullYear(),預算西曆.getMonth()+1,預算西曆.getDate(),西曆時數);ArrayCounter+=1;}else{alert("輸入的八字有問題！！");}}}西曆年份+=60;}return 日期矩陣;};function 年月支尋節氣日期(年,月支){var YearData=年-1923;var 節氣日期;var 曆法數據=萬年曆();switch(月支){case "寅":節氣日期=曆法數據[YearData].立春;break;case "卯":節氣日期=曆法數據[YearData].驚蟄;break;case "辰":節氣日期=曆法數據[YearData].清明;break;case "巳":節氣日期=曆法數據[YearData].立夏;break;case "午":節氣日期=曆法數據[YearData].芒種;break;case "未":節氣日期=曆法數據[YearData].小暑;break;case "申":節氣日期=曆法數據[YearData].立秋;break;case "酉":節氣日期=曆法數據[YearData].白露;break;case "戌":節氣日期=曆法數據[YearData].寒露;break;case "亥":節氣日期=曆法數據[YearData].立冬;break;case "子":節氣日期=曆法數據[YearData].大雪;break;case "丑":節氣日期=曆法數據[YearData+1].小寒;break;}return 日曆值轉換(節氣日期,1);}