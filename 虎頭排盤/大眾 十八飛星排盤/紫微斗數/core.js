function 計算飛星命盤(輸入,系統設定){var 輸入生日=new 日期格式(輸入.西曆日期);var 干支曆=轉換干支曆(輸入);var 農曆=農曆轉換(輸入.西曆日期);var 陰曆=陰曆轉換(農曆);var 曆法={"干支曆":干支曆,"農曆":農曆,"陰曆":陰曆,"備註":""};this.輸入=輸入;this.曆法=曆法;this.運行={"大限數": -1,"流年數": -1,"流年地支數": -1,"流年十神":"","大限流年矩陣數": -1,"大限":false,"流年":false,"流年干支":"","架構飛四化分析":""};this.生日={"西曆生日":輸入.西曆日期,"運算生日":曆法.干支曆.運算的西曆,"西曆生日格式":new 日期格式(輸入.西曆日期),"西曆年":輸入生日.Year,"生日年":(曆法.陰曆.騎年)?輸入生日.Year-1:輸入生日.Year,"西曆月":輸入生日.Month,"西曆日":輸入生日.Day,"西曆時":輸入生日.Hour,"西曆分":輸入生日.Minute,"西曆中文":(輸入.西曆日期.getSeconds()==1)?輸入生日.西曆日期:輸入生日.西曆,"西曆英文":輸入生日.MalaysiaDate,"性別":輸入.性別,"星座":尋星座(輸入生日.Month,輸入生日.Day,1),"陰曆":曆法.陰曆.陰曆日期,"陰曆年":曆法.陰曆.干支年,"陰曆月":曆法.陰曆.月,"陰曆日":曆法.陰曆.日,"陰曆時":調整陰曆時,"陰曆時數":地支字數轉換(調整陰曆時),"生肖":曆法.陰曆.生肖,"閏年":曆法.陰曆.閏年,"備註":""};this.八字=曆法.干支曆.四柱;this.日主=曆法.干支曆.四柱.substr(4,1);this.生年天干=this.生日.陰曆年.substr(0,1);this.生年天干數=天干(this.生年天干);this.陽男陰女=陽男陰女(this.生日.性別,this.生日.陰曆年.substr(1,1));this.人事宮=new 人事宮位();this.星曜=new 星曜初始();this.地支宮位=[];for(var i=0;i<12;i++){this.地支宮位.push(new 地支宮位元件(i));}填寫宮干四化(this.地支宮位,this.生年天干數);填寫人事宮位(this.地支宮位,this.人事宮,this.命宮地支數);this.五行局=五行局(this.人事宮.命宮.天干數,this.人事宮.命宮.地支數);this.紫微位置=地支紫微(this.生日.陰曆日,this.五行局.局名);十四主星(this.紫微位置.地支,this.地支宮位,this.星曜);輔弼(this.生日.陰曆月,this.地支宮位,this.星曜);昌曲(this.生日.陰曆時數,this.地支宮位,this.星曜);空宮(this.地支宮位);刷新星曜宮位(this.星曜,this.地支宮位);安生年四化(this.生年天干,this.地支宮位,this.人事宮,this.星曜);尋宮干四化(this.地支宮位,this.星曜);尋自化流出(this.地支宮位,this.星曜);this.大限=[];for(var i=0;i<13;i++){this.大限.push(new 大限(i));}安大限(this.大限,this.生日.陰曆年,this.命宮地支數,this.五行局.局數,this.陽男陰女,this.地支宮位);安流年(this.大限,this.生日.生日年,this.生日.陰曆年,this.五行局.局數,this.日主,this.生日.騎年);};function 命宮的地支(陰曆月數,陰曆時辰){var 陰曆時數=地支字數轉換(陰曆時辰);var 命宮位置=3;var 命宮地支數;命宮地支數=地支滾動(命宮位置,陰曆月數);命宮地支數=地支滾動(命宮地支數,(-1)*陰曆時數);return 命宮地支數;};function 宮干的四化(地支矩陣,生年天干數){var 寅宮天干數=(2*生年天干數+1)%10;var 寅宮數=3;for(var i=0;i<12;i++){地支矩陣[滾動(寅宮數,i)].宮干數=滾動(寅宮天干數,i);地支矩陣[滾動(寅宮數,i)].宮干=字數轉換(宮干數);}};function 人事的宮位(地支矩陣,人事宮元件,命宮地支數){var 宮名;for(var i=0;i<12;i++){地支矩陣[地支滾動(命宮地支數,(-1)*i)].宮位數=滾動(1,i);宮名=人事宮字數轉換(地支矩陣[地支滾動(命宮地支數,(-1)*i)].宮位數);地支矩陣[滾動(命宮地支數,(-1)*i)].宮位=宮名;地支矩陣[滾動(命宮地支數,(-1)*i)].六線=宮位轉六線(宮名);人事宮元件[宮名].地支數=滾動(命宮地支數,(-1)*i);人事宮元件[宮名].地支=字數轉換(人事宮元件[宮名].地支數);人事宮元件[宮名].天干數=地支矩陣[地支滾動(命宮地支數,(-1)*i)].宮干數;人事宮元件[宮名].天干=字數轉換(人事宮元件[宮名].天干數);}};function 尋紫微五行局(命宮宮干,命宮地支){var 命宮干支=天干字數轉換(命宮宮干)+地支字數轉換(命宮地支);var 五行局數,五行局名;switch(命宮干支){case "丙子":case "丁丑":case "甲寅":case "乙卯":case "壬辰":case "癸巳":case "丙午":case "丁未":case "甲申":case "乙酉":case "壬戌":case "癸亥":五行局數=2;五行局名="水二局";break;case "壬子":case "癸丑":case "庚寅":case "辛卯":case "戊辰":case "己巳":case "壬午":case "癸未":case "庚申":case "辛酉":case "戊戌":case "己亥":五行局數=3;五行局名="木三局";break;case "甲子":case "乙丑":case "壬寅":case "癸卯":case "庚辰":case "辛巳":case "甲午":case "乙未":case "壬申":case "癸酉":case "庚戌":case "辛亥":五行局數=4;五行局名="金四局";break;case "庚子":case "辛丑":case "戊寅":case "己卯":case "丙辰":case "丁巳":case "庚午":case "辛未":case "戊申":case "己酉":case "丙戌":case "丁亥":五行局數=5;五行局名="土五局";break;case "戊子":case "己丑":case "丙寅":case "丁卯":case "甲辰":case "乙巳":case "戊午":case "己未":case "丙申":case "丁酉":case "甲戌":case "乙亥":五行局數=6;五行局名="火六局";break;default:alert(命宮干支+"：命宮干支 出現問題");五行局數=0;五行局名="";}var 五行局元件={"干支":命宮干支,"局數":五行局數,"局名":五行局名};return 五行局元件;};function 尋紫微的地支(陰曆生日,五行局){var 紫微地支矩陣=[{"生日":1,"水二局":"丑","木三局":"辰","金四局":"亥","土五局":"午","火六局":"酉"},{"生日":2,"水二局":"寅","木三局":"丑","金四局":"辰","土五局":"亥","火六局":"午"},{"生日":3,"水二局":"寅","木三局":"寅","金四局":"丑","土五局":"辰","火六局":"亥"},{"生日":5,"水二局":"卯","木三局":"寅","金四局":"子","土五局":"寅","火六局":"丑"},{"生日":6,"水二局":"辰","木三局":"卯","金四局":"巳","土五局":"未","火六局":"寅"},{"生日":7,"水二局":"辰","木三局":"午","金四局":"寅","土五局":"子","火六局":"戌"},{"生日":9,"水二局":"巳","木三局":"辰","金四局":"丑","土五局":"寅","火六局":"子"},{"生日":10,"水二局":"午","木三局":"未","金四局":"午","土五局":"卯","火六局":"巳"},{"生日":11,"水二局":"午","木三局":"辰","金四局":"卯","土五局":"申","火六局":"寅"},{"生日":12,"水二局":"未","木三局":"巳","金四局":"辰","土五局":"丑","火六局":"卯"},{"生日":13,"水二局":"未","木三局":"申","金四局":"寅","土五局":"午","火六局":"亥"},{"生日":14,"水二局":"申","木三局":"巳","金四局":"未","土五局":"卯","火六局":"申"},{"生日":15,"水二局":"申","木三局":"午","金四局":"辰","土五局":"辰","火六局":"丑"},{"生日":16,"水二局":"酉","木三局":"酉","金四局":"巳","土五局":"酉","火六局":"午"},{"生日":17,"水二局":"酉","木三局":"午","金四局":"卯","土五局":"寅","火六局":"卯"},{"生日":18,"水二局":"戌","木三局":"未","金四局":"申","土五局":"未","火六局":"辰"},{"生日":20,"水二局":"亥","木三局":"未","金四局":"午","土五局":"巳","火六局":"酉"},{"生日":21,"水二局":"亥","木三局":"申","金四局":"辰","土五局":"戌","火六局":"寅"},{"生日":22,"水二局":"子","木三局":"亥","金四局":"酉","土五局":"卯","火六局":"未"},{"生日":23,"水二局":"子","木三局":"申","金四局":"午","土五局":"申","火六局":"辰"},{"生日":24,"水二局":"丑","木三局":"酉","金四局":"未","土五局":"巳","火六局":"巳"},{"生日":25,"水二局":"丑","木三局":"子","金四局":"巳","土五局":"午","火六局":"丑"},{"生日":26,"水二局":"寅","木三局":"酉","金四局":"戌","土五局":"亥","火六局":"戌"},{"生日":27,"水二局":"寅","木三局":"戌","金四局":"未","土五局":"辰","火六局":"卯"},{"生日":28,"水二局":"卯","木三局":"丑","金四局":"申","土五局":"酉","火六局":"申"},{"生日":29,"水二局":"卯","木三局":"戌","金四局":"午","土五局":"午","火六局":"巳"},{"生日":30,"水二局":"辰","木三局":"亥","金四局":"亥","土五局":"未","火六局":"午"}];var 資料索引=_.findIndex(紫微地支矩陣,{生日:陰曆生日});if(資料索引!= -1){var 紫微地支=紫微地支矩陣[資料索引][五行局];var 紫微地支元件={"地支":紫微地支,"地支數":地支字數(紫微地支),"五行局":五行局,"生日":陰曆生日};return 紫微地支元件;}else alert(陰曆生日+"，"+五行局+"紫微地支計算錯誤！");};function 安十四顆主星(紫微地支,地支矩陣,星曜){switch(紫微地支){case "子":地支矩陣[0].星曜.push("天機");星曜["天機"].地支數=0;星曜["天機"].地支="亥";地支矩陣[1].星曜.push("紫微");星曜["紫微"].地支數=1;星曜["紫微"].地支="子";地支矩陣[3].星曜.push("破軍");星曜["破軍"].地支數=3;星曜["破軍"].地支="寅";地支矩陣[5].星曜.push("廉貞");星曜["廉貞"].地支數=5;星曜["廉貞"].地支="辰";地支矩陣[5].星曜.push("天府");星曜["天府"].地支數=5;星曜["天府"].地支="辰";地支矩陣[6].星曜.push("太陰");星曜["太陰"].地支數=6;星曜["太陰"].地支="巳";地支矩陣[7].星曜.push("貪狼");星曜["貪狼"].地支數=7;星曜["貪狼"].地支="午";地支矩陣[8].星曜.push("天同");星曜["天同"].地支數=8;星曜["天同"].地支="未";地支矩陣[8].星曜.push("巨門");星曜["巨門"].地支數=8;星曜["巨門"].地支="未";地支矩陣[9].星曜.push("武曲");星曜["武曲"].地支數=9;星曜["武曲"].地支="申";地支矩陣[9].星曜.push("天相");星曜["天相"].地支數=9;星曜["天相"].地支="申";地支矩陣[10].星曜.push("太陽");星曜["太陽"].地支數=10;星曜["太陽"].地支="酉";地支矩陣[10].星曜.push("天梁");星曜["天梁"].地支數=10;星曜["天梁"].地支="酉";地支矩陣[11].星曜.push("七殺");星曜["七殺"].地支數=11;星曜["七殺"].地支="戌";break;case "丑":地支矩陣[1].星曜.push("天機");星曜["天機"].地支數=1;星曜["天機"].地支="子";地支矩陣[2].星曜.push("紫微");星曜["紫微"].地支數=2;星曜["紫微"].地支="丑";地支矩陣[2].星曜.push("破軍");星曜["破軍"].地支數=2;星曜["破軍"].地支="丑";地支矩陣[4].星曜.push("天府");星曜["天府"].地支數=4;星曜["天府"].地支="卯";地支矩陣[5].星曜.push("太陰");星曜["太陰"].地支數=5;星曜["太陰"].地支="辰";地支矩陣[6].星曜.push("廉貞");星曜["廉貞"].地支數=6;星曜["廉貞"].地支="巳";地支矩陣[6].星曜.push("貪狼");星曜["貪狼"].地支數=6;星曜["貪狼"].地支="巳";地支矩陣[7].星曜.push("巨門");星曜["巨門"].地支數=7;星曜["巨門"].地支="午";地支矩陣[8].星曜.push("天相");星曜["天相"].地支數=8;星曜["天相"].地支="未";地支矩陣[9].星曜.push("天同");星曜["天同"].地支數=9;星曜["天同"].地支="申";地支矩陣[9].星曜.push("天梁");星曜["天梁"].地支數=9;星曜["天梁"].地支="申";地支矩陣[10].星曜.push("武曲");星曜["武曲"].地支數=10;星曜["武曲"].地支="酉";地支矩陣[10].星曜.push("七殺");星曜["七殺"].地支數=10;星曜["七殺"].地支="酉";地支矩陣[11].星曜.push("太陽");星曜["太陽"].地支數=11;星曜["太陽"].地支="戌";break;case "寅":地支矩陣[0].星曜.push("太陽");星曜["太陽"].地支數=0;星曜["太陽"].地支="亥";地支矩陣[1].星曜.push("破軍");星曜["破軍"].地支數=1;星曜["破軍"].地支="子";地支矩陣[2].星曜.push("天機");星曜["天機"].地支數=2;星曜["天機"].地支="丑";地支矩陣[3].星曜.push("紫微");星曜["紫微"].地支數=3;星曜["紫微"].地支="寅";地支矩陣[3].星曜.push("天府");星曜["天府"].地支數=3;星曜["天府"].地支="寅";地支矩陣[4].星曜.push("太陰");星曜["太陰"].地支數=4;星曜["太陰"].地支="卯";地支矩陣[5].星曜.push("貪狼");星曜["貪狼"].地支數=5;星曜["貪狼"].地支="辰";地支矩陣[6].星曜.push("巨門");星曜["巨門"].地支數=6;星曜["巨門"].地支="巳";地支矩陣[7].星曜.push("廉貞");星曜["廉貞"].地支數=7;星曜["廉貞"].地支="午";地支矩陣[7].星曜.push("天相");星曜["天相"].地支數=7;星曜["天相"].地支="午";地支矩陣[8].星曜.push("天梁");星曜["天梁"].地支數=8;星曜["天梁"].地支="未";地支矩陣[9].星曜.push("七殺");星曜["七殺"].地支數=9;星曜["七殺"].地支="申";地支矩陣[10].星曜.push("天同");星曜["天同"].地支數=10;星曜["天同"].地支="酉";地支矩陣[11].星曜.push("武曲");星曜["武曲"].地支數=11;星曜["武曲"].地支="戌";break;case "卯":地支矩陣[0].星曜.push("武曲");星曜["武曲"].地支數=0;星曜["武曲"].地支="亥";地支矩陣[0].星曜.push("破軍");星曜["破軍"].地支數=0;星曜["破軍"].地支="亥";地支矩陣[1].星曜.push("太陽");星曜["太陽"].地支數=1;星曜["太陽"].地支="子";地支矩陣[2].星曜.push("天府");星曜["天府"].地支數=2;星曜["天府"].地支="丑";地支矩陣[3].星曜.push("天機");星曜["天機"].地支數=3;星曜["天機"].地支="寅";地支矩陣[3].星曜.push("太陰");星曜["太陰"].地支數=3;星曜["太陰"].地支="寅";地支矩陣[4].星曜.push("紫微");星曜["紫微"].地支數=4;星曜["紫微"].地支="卯";地支矩陣[4].星曜.push("貪狼");星曜["貪狼"].地支數=4;星曜["貪狼"].地支="卯";地支矩陣[5].星曜.push("巨門");星曜["巨門"].地支數=5;星曜["巨門"].地支="辰";地支矩陣[6].星曜.push("天相");星曜["天相"].地支數=6;星曜["天相"].地支="巳";地支矩陣[7].星曜.push("天梁");星曜["天梁"].地支數=7;星曜["天梁"].地支="午";地支矩陣[8].星曜.push("廉貞");星曜["廉貞"].地支數=8;星曜["廉貞"].地支="未";地支矩陣[8].星曜.push("七殺");星曜["七殺"].地支數=8;星曜["七殺"].地支="未";地支矩陣[11].星曜.push("天同");星曜["天同"].地支數=11;星曜["天同"].地支="戌";break;case "辰":地支矩陣[0].星曜.push("天同");星曜["天同"].地支數=0;星曜["天同"].地支="亥";地支矩陣[1].星曜.push("武曲");星曜["武曲"].地支數=1;星曜["武曲"].地支="子";地支矩陣[1].星曜.push("天府");星曜["天府"].地支數=1;星曜["天府"].地支="子";地支矩陣[2].星曜.push("太陽");星曜["太陽"].地支數=2;星曜["太陽"].地支="丑";地支矩陣[2].星曜.push("太陰");星曜["太陰"].地支數=2;星曜["太陰"].地支="丑";地支矩陣[3].星曜.push("貪狼");星曜["貪狼"].地支數=3;星曜["貪狼"].地支="寅";地支矩陣[4].星曜.push("天機");星曜["天機"].地支數=4;星曜["天機"].地支="卯";地支矩陣[4].星曜.push("巨門");星曜["巨門"].地支數=4;星曜["巨門"].地支="卯";地支矩陣[5].星曜.push("紫微");星曜["紫微"].地支數=5;星曜["紫微"].地支="辰";地支矩陣[5].星曜.push("天相");星曜["天相"].地支數=5;星曜["天相"].地支="辰";地支矩陣[6].星曜.push("天梁");星曜["天梁"].地支數=6;星曜["天梁"].地支="巳";地支矩陣[7].星曜.push("七殺");星曜["七殺"].地支數=7;星曜["七殺"].地支="午";地支矩陣[9].星曜.push("廉貞");星曜["廉貞"].地支數=9;星曜["廉貞"].地支="申";地支矩陣[11].星曜.push("破軍");星曜["破軍"].地支數=11;星曜["破軍"].地支="戌";break;case "巳":地支矩陣[0].星曜.push("天府");星曜["天府"].地支數=0;星曜["天府"].地支="亥";地支矩陣[1].星曜.push("天同");星曜["天同"].地支數=1;星曜["天同"].地支="子";地支矩陣[1].星曜.push("太陰");星曜["太陰"].地支數=1;星曜["太陰"].地支="子";地支矩陣[2].星曜.push("武曲");星曜["武曲"].地支數=2;星曜["武曲"].地支="丑";地支矩陣[2].星曜.push("貪狼");星曜["貪狼"].地支數=2;星曜["貪狼"].地支="丑";地支矩陣[3].星曜.push("太陽");星曜["太陽"].地支數=3;星曜["太陽"].地支="寅";地支矩陣[3].星曜.push("巨門");星曜["巨門"].地支數=3;星曜["巨門"].地支="寅";地支矩陣[4].星曜.push("天相");星曜["天相"].地支數=4;星曜["天相"].地支="卯";地支矩陣[5].星曜.push("天機");星曜["天機"].地支數=5;星曜["天機"].地支="辰";地支矩陣[5].星曜.push("天梁");星曜["天梁"].地支數=5;星曜["天梁"].地支="辰";地支矩陣[6].星曜.push("紫微");星曜["紫微"].地支數=6;星曜["紫微"].地支="巳";地支矩陣[6].星曜.push("七殺");星曜["七殺"].地支數=6;星曜["七殺"].地支="巳";地支矩陣[10].星曜.push("廉貞");星曜["廉貞"].地支數=10;星曜["廉貞"].地支="酉";地支矩陣[10].星曜.push("破軍");星曜["破軍"].地支數=10;星曜["破軍"].地支="酉";break;case "午":地支矩陣[0].星曜.push("太陰");星曜["太陰"].地支數=0;星曜["太陰"].地支="亥";地支矩陣[1].星曜.push("貪狼");星曜["貪狼"].地支數=1;星曜["貪狼"].地支="子";地支矩陣[2].星曜.push("天同");星曜["天同"].地支數=2;星曜["天同"].地支="丑";地支矩陣[2].星曜.push("巨門");星曜["巨門"].地支數=2;星曜["巨門"].地支="丑";地支矩陣[3].星曜.push("武曲");星曜["武曲"].地支數=3;星曜["武曲"].地支="寅";地支矩陣[3].星曜.push("天相");星曜["天相"].地支數=3;星曜["天相"].地支="寅";地支矩陣[4].星曜.push("太陽");星曜["太陽"].地支數=4;星曜["太陽"].地支="卯";地支矩陣[4].星曜.push("天梁");星曜["天梁"].地支數=4;星曜["天梁"].地支="卯";地支矩陣[5].星曜.push("七殺");星曜["七殺"].地支數=5;星曜["七殺"].地支="辰";地支矩陣[6].星曜.push("天機");星曜["天機"].地支數=6;星曜["天機"].地支="巳";地支矩陣[7].星曜.push("紫微");星曜["紫微"].地支數=7;星曜["紫微"].地支="午";地支矩陣[9].星曜.push("破軍");星曜["破軍"].地支數=9;星曜["破軍"].地支="申";地支矩陣[11].星曜.push("廉貞");星曜["廉貞"].地支數=11;星曜["廉貞"].地支="戌";地支矩陣[11].星曜.push("天府");星曜["天府"].地支數=11;星曜["天府"].地支="戌";break;case "未":地支矩陣[0].星曜.push("廉貞");星曜["廉貞"].地支數=0;星曜["廉貞"].地支="亥";地支矩陣[0].星曜.push("貪狼");星曜["貪狼"].地支數=0;星曜["貪狼"].地支="亥";地支矩陣[1].星曜.push("巨門");星曜["巨門"].地支數=1;星曜["巨門"].地支="子";地支矩陣[2].星曜.push("天相");星曜["天相"].地支數=2;星曜["天相"].地支="丑";地支矩陣[3].星曜.push("天同");星曜["天同"].地支數=3;星曜["天同"].地支="寅";地支矩陣[3].星曜.push("天梁");星曜["天梁"].地支數=3;星曜["天梁"].地支="寅";地支矩陣[4].星曜.push("武曲");星曜["武曲"].地支數=4;星曜["武曲"].地支="卯";地支矩陣[4].星曜.push("七殺");星曜["七殺"].地支數=4;星曜["七殺"].地支="卯";地支矩陣[5].星曜.push("太陽");星曜["太陽"].地支數=5;星曜["太陽"].地支="辰";地支矩陣[7].星曜.push("天機");星曜["天機"].地支數=7;星曜["天機"].地支="午";地支矩陣[8].星曜.push("紫微");星曜["紫微"].地支數=8;星曜["紫微"].地支="未";地支矩陣[8].星曜.push("破軍");星曜["破軍"].地支數=8;星曜["破軍"].地支="未";地支矩陣[10].星曜.push("天府");星曜["天府"].地支數=10;星曜["天府"].地支="酉";地支矩陣[11].星曜.push("太陰");星曜["太陰"].地支數=11;星曜["太陰"].地支="戌";break;case "申":地支矩陣[0].星曜.push("巨門");星曜["巨門"].地支數=0;星曜["巨門"].地支="亥";地支矩陣[1].星曜.push("廉貞");星曜["廉貞"].地支數=1;星曜["廉貞"].地支="子";地支矩陣[1].星曜.push("天相");星曜["天相"].地支數=1;星曜["天相"].地支="子";地支矩陣[2].星曜.push("天梁");星曜["天梁"].地支數=2;星曜["天梁"].地支="丑";地支矩陣[3].星曜.push("七殺");星曜["七殺"].地支數=3;星曜["七殺"].地支="寅";地支矩陣[4].星曜.push("天同");星曜["天同"].地支數=4;星曜["天同"].地支="卯";地支矩陣[5].星曜.push("武曲");星曜["武曲"].地支數=5;星曜["武曲"].地支="辰";地支矩陣[6].星曜.push("太陽");星曜["太陽"].地支數=6;星曜["太陽"].地支="巳";地支矩陣[7].星曜.push("破軍");星曜["破軍"].地支數=7;星曜["破軍"].地支="午";地支矩陣[8].星曜.push("天機");星曜["天機"].地支數=8;星曜["天機"].地支="未";地支矩陣[9].星曜.push("紫微");星曜["紫微"].地支數=9;星曜["紫微"].地支="申";地支矩陣[9].星曜.push("天府");星曜["天府"].地支數=9;星曜["天府"].地支="申";地支矩陣[10].星曜.push("太陰");星曜["太陰"].地支數=10;星曜["太陰"].地支="酉";地支矩陣[11].星曜.push("貪狼");星曜["貪狼"].地支數=11;星曜["貪狼"].地支="戌";break;case "酉":地支矩陣[0].星曜.push("天相");星曜["天相"].地支數=0;星曜["天相"].地支="亥";地支矩陣[1].星曜.push("天梁");星曜["天梁"].地支數=1;星曜["天梁"].地支="子";地支矩陣[2].星曜.push("廉貞");星曜["廉貞"].地支數=2;星曜["廉貞"].地支="丑";地支矩陣[2].星曜.push("七殺");星曜["七殺"].地支數=2;星曜["七殺"].地支="丑";地支矩陣[5].星曜.push("天同");星曜["天同"].地支數=5;星曜["天同"].地支="辰";地支矩陣[6].星曜.push("武曲");星曜["武曲"].地支數=6;星曜["武曲"].地支="巳";地支矩陣[6].星曜.push("破軍");星曜["破軍"].地支數=6;星曜["破軍"].地支="巳";地支矩陣[7].星曜.push("太陽");星曜["太陽"].地支數=7;星曜["太陽"].地支="午";地支矩陣[8].星曜.push("天府");星曜["天府"].地支數=8;星曜["天府"].地支="未";地支矩陣[9].星曜.push("天機");星曜["天機"].地支數=9;星曜["天機"].地支="申";地支矩陣[9].星曜.push("太陰");星曜["太陰"].地支數=9;星曜["太陰"].地支="申";地支矩陣[10].星曜.push("紫微");星曜["紫微"].地支數=10;星曜["紫微"].地支="酉";地支矩陣[10].星曜.push("貪狼");星曜["貪狼"].地支數=10;星曜["貪狼"].地支="酉";地支矩陣[11].星曜.push("巨門");星曜["巨門"].地支數=11;星曜["巨門"].地支="戌";break;case "戌":地支矩陣[0].星曜.push("天梁");星曜["天梁"].地支數=0;星曜["天梁"].地支="亥";地支矩陣[1].星曜.push("七殺");星曜["七殺"].地支數=1;星曜["七殺"].地支="子";地支矩陣[3].星曜.push("廉貞");星曜["廉貞"].地支數=3;星曜["廉貞"].地支="寅";地支矩陣[5].星曜.push("破軍");星曜["破軍"].地支數=5;星曜["破軍"].地支="辰";地支矩陣[6].星曜.push("天同");星曜["天同"].地支數=6;星曜["天同"].地支="巳";地支矩陣[7].星曜.push("武曲");星曜["武曲"].地支數=7;星曜["武曲"].地支="午";地支矩陣[7].星曜.push("天府");星曜["天府"].地支數=7;星曜["天府"].地支="午";地支矩陣[8].星曜.push("太陽");星曜["太陽"].地支數=8;星曜["太陽"].地支="未";地支矩陣[8].星曜.push("太陰");星曜["太陰"].地支數=8;星曜["太陰"].地支="未";地支矩陣[9].星曜.push("貪狼");星曜["貪狼"].地支數=9;星曜["貪狼"].地支="申";地支矩陣[10].星曜.push("天機");星曜["天機"].地支數=10;星曜["天機"].地支="酉";地支矩陣[10].星曜.push("巨門");星曜["巨門"].地支數=10;星曜["巨門"].地支="酉";地支矩陣[11].星曜.push("紫微");星曜["紫微"].地支數=11;星曜["紫微"].地支="戌";地支矩陣[11].星曜.push("天相");星曜["天相"].地支數=11;星曜["天相"].地支="戌";break;case "亥":地支矩陣[0].星曜.push("紫微");星曜["紫微"].地支數=0;星曜["紫微"].地支="亥";地支矩陣[0].星曜.push("七殺");星曜["七殺"].地支數=0;星曜["七殺"].地支="亥";地支矩陣[4].星曜.push("廉貞");星曜["廉貞"].地支數=4;星曜["廉貞"].地支="卯";地支矩陣[4].星曜.push("破軍");星曜["破軍"].地支數=4;星曜["破軍"].地支="卯";地支矩陣[6].星曜.push("天府");星曜["天府"].地支數=6;星曜["天府"].地支="巳";地支矩陣[7].星曜.push("天同");星曜["天同"].地支數=7;星曜["天同"].地支="午";地支矩陣[7].星曜.push("太陰");星曜["太陰"].地支數=7;星曜["太陰"].地支="午";地支矩陣[8].星曜.push("武曲");星曜["武曲"].地支數=8;星曜["武曲"].地支="未";地支矩陣[8].星曜.push("貪狼");星曜["貪狼"].地支數=8;星曜["貪狼"].地支="未";地支矩陣[9].星曜.push("太陽");星曜["太陽"].地支數=9;星曜["太陽"].地支="申";地支矩陣[9].星曜.push("巨門");星曜["巨門"].地支數=9;星曜["巨門"].地支="申";地支矩陣[10].星曜.push("天相");星曜["天相"].地支數=10;星曜["天相"].地支="酉";地支矩陣[11].星曜.push("天機");星曜["天機"].地支數=11;星曜["天機"].地支="戌";地支矩陣[11].星曜.push("天梁");星曜["天梁"].地支數=11;星曜["天梁"].地支="戌";break;}};function 安左輔右弼(生月,地支矩陣,星曜){if(生月==0)生月=12;地支矩陣[地支滾動(5,(生月-1))].星曜.push("左輔");地支矩陣[地支滾動(11,(-1)*(生月-1))].星曜.push("右弼");星曜["左輔"].地支數=地支滾動(5,(生月-1));星曜["左輔"].地支=地支字數轉換(地支滾動(5,(生月-1)));星曜["右弼"].地支數=地支滾動(11,(-1)*(生月-1));星曜["右弼"].地支=地支字數轉換(地支滾動(11,(-1)*(生月-1)));};function 安文昌文曲(生時,地支矩陣,星曜){if(生時==0)生時=12;地支矩陣[滾動(5,(生時-1))].星曜.push("文曲");地支矩陣[滾動(11,(-1)*(生時-1))].星曜.push("文昌");星曜["文曲"].地支數=滾動(5,(生時-1));星曜["文曲"].地支=地支字數轉換(滾動(5,(生時-1)));星曜["文昌"].地支數=滾動(11,(-1)*(生時-1));星曜["文昌"].地支=地支字數轉換(滾動(11,(-1)*(生時-1)));};function 安生年的四化(生年干,地支矩陣,人事宮位,星曜){var 生年四化=十干四化(生年干);星曜[生年四化.化祿].生年祿=true;星曜[生年四化.化祿].生年四化="祿";星曜[生年四化.化權].生年權=true;星曜[生年四化.化權].生年四化="權";星曜[生年四化.化科].生年科=true;星曜[生年四化.化科].生年四化="科";星曜[生年四化.化忌].生年忌=true;星曜[生年四化.化忌].生年四化="忌";};function 尋宮干的四化(地支矩陣,星曜){var 宮干,四化,對宮地支;var 化祿對宮,化權對宮,化科對宮,化忌對宮;for(var i=0;i<12;i++){宮干=地支矩陣[i].宮干;四化=十干四化(宮干);對宮地支=地支滾動(i,6);地支矩陣[i].宮干四化.化祿星=四化.化祿;地支矩陣[i].宮干四化.化權星=四化.化權;地支矩陣[i].宮干四化.化科星=四化.化科;地支矩陣[i].宮干四化.化忌星=四化.化忌;化祿對宮=地支滾動(星曜[四化.化祿].地支數,6);化權對宮=地支滾動(星曜[四化.化權].地支數,6);化科對宮=地支滾動(星曜[四化.化科].地支數,6);化忌對宮=地支滾動(星曜[四化.化忌].地支數,6);地支矩陣[i].宮干四化.祿出.地支.push(地支字數轉換(星曜[四化.化祿].地支數));地支矩陣[i].宮干四化.權出.地支.push(地支字數轉換(星曜[四化.化權].地支數));地支矩陣[i].宮干四化.科出.地支.push(地支字數轉換(星曜[四化.化科].地支數));地支矩陣[i].宮干四化.忌出.地支.push(地支字數轉換(星曜[四化.化忌].地支數));地支矩陣[i].宮干四化.忌出沖.地支.push(地支字數轉換(地支滾動(星曜[四化.化忌].地支數,6)));地支矩陣[i].宮干四化.祿出.人事宮.push(地支矩陣[星曜[四化.化祿].地支數].宮位);地支矩陣[i].宮干四化.權出.人事宮.push(地支矩陣[星曜[四化.化權].地支數].宮位);地支矩陣[i].宮干四化.科出.人事宮.push(地支矩陣[星曜[四化.化科].地支數].宮位);地支矩陣[i].宮干四化.忌出.人事宮.push(地支矩陣[星曜[四化.化忌].地支數].宮位);地支矩陣[i].宮干四化.忌出沖.人事宮.push(地支矩陣[地支滾動(星曜[四化.化忌].地支數,6)].宮位);地支矩陣[星曜[四化.化祿].地支數].宮干四化.祿進.地支數.push(i);地支矩陣[星曜[四化.化權].地支數].宮干四化.權進.地支數.push(i);地支矩陣[星曜[四化.化科].地支數].宮干四化.科進.地支數.push(i);地支矩陣[星曜[四化.化忌].地支數].宮干四化.忌進.地支數.push(i);地支矩陣[地支滾動(星曜[四化.化忌].地支數,6)].宮干四化.忌進沖.地支數.push(i);}};function 尋是否自化流出(地支矩陣,星曜){for(var i=0;i<12;i++){if(地支矩陣[i].宮干四化.祿出.地支數==i){地支矩陣[i].宮干四化.自化祿=true;}if(地支矩陣[i].宮干四化.權出.地支數==i){地支矩陣[i].宮干四化.自化權=true;}if(地支矩陣[i].宮干四化.科出.地支數==i){地支矩陣[i].宮干四化.自化科=true;}if(地支矩陣[i].宮干四化.忌出.地支數==i){地支矩陣[i].宮干四化.自化忌=true;}if(地支矩陣[i].宮干四化.祿出.地支數==地支滾動(i,6)){地支矩陣[i].宮干四化.流出祿=true;}if(地支矩陣[i].宮干四化.權出.地支數==地支滾動(i,6)){地支矩陣[i].宮干四化.流出權=true;}if(地支矩陣[i].宮干四化.科出.地支數==地支滾動(i,6)){地支矩陣[i].宮干四化.流出科=true;}if(地支矩陣[i].宮干四化.忌出.地支數==地支滾動(i,6)){地支矩陣[i].宮干四化.流出忌=true;}if(地支矩陣[i].宮干四化.流出祿)地支矩陣[i].宮干四化.流出矩陣.push("祿");if(地支矩陣[i].宮干四化.流出權)地支矩陣[i].宮干四化.流出矩陣.push("權");if(地支矩陣[i].宮干四化.流出忌)地支矩陣[i].宮干四化.流出矩陣.push("忌");}};function 空宮(地支矩陣,選項){if(選項===undefined)選項=1;if(選項==1){for(var i=0;i<12;i++){if(地支矩陣[i].星曜.length==0)地支矩陣[i].空宮=true;}}};function 安各大限(大限,生年干支,命宮地支數,五行局數,男女,地支矩陣){var 順逆=(男女=="陽男"||男女=="陰女")?1: -1;var 歲數句="",地支數;var 歲數分段;for(var i=1;i<13;i++){歲數句=(五行局數+(i-1)*10).toString()+" - "+((五行局數+9)+(i-1)*10).toString();歲數分段=歲數句.split(" - ");大限[i].歲數段=歲數句;大限[i].限始歲=Number(歲數分段[0]);大限[i].限終歲=Number(歲數分段[1]);大限[i].地支數=地支滾動(命宮地支數,(i-1)*順逆);大限[i].大限名="第"+i+"大限";大限[i].宮位干支=地支矩陣[大限[i].地支數].宮干+地支矩陣[大限[i].地支數].地支;地支矩陣[大限[i].地支數].大限數=大限[i].大限數;地支矩陣[大限[i].地支數].大限歲數段=大限[i].歲數段;var 人事宮名="",人事宮地支= -1;for(var j=0;j<12;j++){人事宮名=人事宮字數轉換(j);人事宮地支=大限[i].人事宮[人事宮名];大限[i].地支[人事宮地支].人事宮=人事宮名;大限[i].地支[人事宮地支].六線=宮位轉六線(人事宮名);}}var 生年地支數=地支字數轉換(生年干支.substr(1,1));大限[0].地支數=生年地支數;大限[0].大限名="童限";大限[0].宮位干支=地支矩陣[生年地支數].宮干+地支矩陣[生年地支數].地支;大限[0].人事宮.命宮=大限[0].地支數;};function 安各流年(大限矩陣,出生年份,生年干支,五行局數,日主,騎年){var 生年地支數=地支字數轉換(生年干支.substr(1,1));var 起運地支數=地支滾動(生年地支數,五行局數-2);var 起歲=五行局數;var 起運年=出生年份+五行局數-1;var 流年西曆;for(var i=1;i<12;i++){for(var j=0;j<10;j++){流年西曆=起運年++;起運地支數=地支滾動(起運地支數,1);大限矩陣[i].流年[j].歲數=起歲++;大限矩陣[i].流年[j].地支數=起運地支數;大限矩陣[i].流年[j].地支=地支字數轉換(起運地支數);大限矩陣[i].流年[j].西曆年=流年西曆;大限矩陣[i].流年[j].大限流年數=j+1;大限矩陣[i].流年[j].流年天干十神=尋十神(大限矩陣[i].流年[j].流年干支.substr(0,1),日主);}}for(var i=0;i<五行局數;i++){大限矩陣[0].流年[i].歲數=i+1;大限矩陣[0].流年[i].地支數=地支滾動(生年地支數,i);大限矩陣[0].流年[i].地支=地支字數轉換(大限矩陣[0].流年[i].地支數);大限矩陣[0].流年[i].西曆年=出生年份+i;大限矩陣[0].流年[i].大限流年數=i+1;大限矩陣[0].流年[i].流年天干十神=尋十神(大限矩陣[0].流年[i].流年干支.substr(0,1),日主);}};function 計算大限流年(出生年份,五行局數,運行元件,大限元件){var 現在日期=new Date();var 當下歲數=現在日期.getFullYear()-出生年份+1;var StartAge,EndAge;for(var i=1;i<10;i++){StartAge=(五行局數)+((i-1)*10);EndAge=(五行局數-1)+(i*10);if(當下歲數>=StartAge&&當下歲數<=EndAge){運行元件.大限數=i;break;}if(當下歲數>0||當下歲數<五行局數){運行元件.大限數=0;}}運行元件.流年數=現在日期.getFullYear();運行元件.歲數=當下歲數;for(var i=0;i<10;i++){if(大限元件[運行元件.大限數].流年[i].西曆年==運行元件.流年數){運行元件.大限流年矩陣數=i;break;}}if(當下歲數>0){運行元件.流年干支=大限元件[運行元件.大限數].流年[運行元件.大限流年矩陣數].流年干支;運行元件.流年十神=大限元件[運行元件.大限數].流年[運行元件.大限流年矩陣數].流年天干十神;}else{var 立春干支曆=萬年曆("立春干支曆",Number(運行元件.流年數));運行元件.流年干支=立春干支曆.substr(0,2);}運行元件.流年地支數=地支字數轉換(運行元件.流年干支.substr(1,1));};function 天干通根(命盤){var 年干月令={"運星":日干月令對照(命盤.年柱.天干,命盤.月令,"旺相休囚死")};var 月干月令={"運星":日干月令對照(命盤.年柱.天干,命盤.月令,"旺相休囚死")};var 日干月令={"運星":日干月令對照(命盤.年柱.天干,命盤.月令,"旺相休囚死")};var 時干月令={"運星":日干月令對照(命盤.年柱.天干,命盤.月令,"旺相休囚死")};if(年干月令.運星=="旺"){命盤.年干.通根.月=true;命盤.分析.四柱.四柱數據[0].通根.月=true;命盤.年干.通根.數+=1;命盤.分析.四柱.四柱數據[0].通根.數+=1;命盤.月支.透干.年=true;命盤.分析.四柱.四柱數據[1].透干.年=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[1].透干.數+=1;}if(日干月令.運星=="旺"){命盤.日干.通根.月=true;命盤.分析.四柱.四柱數據[2].通根.月=true;命盤.日干.通根.數+=1;命盤.分析.四柱.四柱數據[2].通根.數+=1;命盤.月支.透干.日=true;命盤.分析.四柱.四柱數據[1].透干.日=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[1].透干.數+=1;}if(時干月令.運星=="旺"){命盤.時干.通根.月=true;命盤.分析.四柱.四柱數據[3].通根.月=true;命盤.時干.通根.數+=1;命盤.分析.四柱.四柱數據[3].通根.數+=1;命盤.月支.透干.時=true;命盤.分析.四柱.四柱數據[1].透干.時=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[1].透干.數+=1;}var 年干坐基={"形態":六十干支屬性(命盤.年柱.干支,"干支關係")};var 月干坐基={"形態":六十干支屬性(命盤.月柱.干支,"干支關係")};var 日干坐基={"形態":六十干支屬性(命盤.日柱.干支,"干支關係")};var 時干坐基={"形態":六十干支屬性(命盤.時柱.干支,"干支關係")};if(年干坐基.形態=="專氣"){命盤.年干.通根.年=true;命盤.分析.四柱.四柱數據[0].通根.年=true;命盤.年干.通根.數+=1;命盤.分析.四柱.四柱數據[0].通根.數+=1;命盤.年支.透干.年=true;命盤.分析.四柱.四柱數據[0].透干.年=true;命盤.年支.透干.數+=1;命盤.分析.四柱.四柱數據[0].透干.數+=1;}if(月干坐基.形態=="專氣"){命盤.月干.通根.月=true;命盤.分析.四柱.四柱數據[1].通根.月=true;命盤.月干.通根.數+=1;命盤.分析.四柱.四柱數據[1].通根.數+=1;命盤.月支.透干.月=true;命盤.分析.四柱.四柱數據[1].透干.月=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[1].透干.數+=1;}if(日干坐基.形態=="專氣"){命盤.日干.通根.日=true;命盤.分析.四柱.四柱數據[2].通根.日=true;命盤.日干.通根.數+=1;命盤.分析.四柱.四柱數據[2].通根.數+=1;命盤.日支.透干.日=true;命盤.分析.四柱.四柱數據[2].透干.日=true;命盤.日支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(時干坐基.形態=="專氣"){命盤.時干.通根.時=true;命盤.分析.四柱.四柱數據[3].通根.時=true;命盤.時干.通根.數+=1;命盤.分析.四柱.四柱數據[3].通根.數+=1;命盤.時支.透干.時=true;命盤.分析.四柱.四柱數據[3].透干.時=true;命盤.時支.透干.數+=1;命盤.分析.四柱.四柱數據[3].透干.數+=1;}if(命盤.日干.五行==命盤.年支.五行){命盤.日干.通根.年=true;命盤.分析.四柱.四柱數據[2].通根.年=true;命盤.日干.通根.數+=1;命盤.分析.四柱.四柱數據[2].通根.數+=1;}if(命盤.日干.五行==命盤.時支.五行){命盤.日干.通根.時=true;命盤.分析.四柱.四柱數據[2].通根.時=true;命盤.日干.通根.數+=1;命盤.分析.四柱.四柱數據[2].通根.數+=1;}if(命盤.月干.五行==命盤.年支.五行){命盤.月干.通根.年=true;命盤.分析.四柱.四柱數據[1].通根.年=true;命盤.月干.通根.數+=1;命盤.分析.四柱.四柱數據[1].通根.數+=1;}if(命盤.月干.五行==命盤.日支.五行){命盤.月干.通根.日=true;命盤.分析.四柱.四柱數據[1].通根.日=true;命盤.月干.通根.數+=1;命盤.分析.四柱.四柱數據[1].通根.數+=1;}if(命盤.月干.五行==命盤.時支.五行){命盤.月干.通根.時=true;命盤.分析.四柱.四柱數據[1].通根.時=true;命盤.月干.通根.數+=1;命盤.分析.四柱.四柱數據[1].通根.數+=1;}if(命盤.時干.五行==命盤.日支.五行){命盤.時干.通根.日=true;命盤.分析.四柱.四柱數據[3].通根.日=true;命盤.時干.通根.數+=1;命盤.分析.四柱.四柱數據[3].通根.數+=1;}if(命盤.時干.五行==命盤.年支.五行){命盤.時干.通根.年=true;命盤.分析.四柱.四柱數據[3].通根.年=true;命盤.時干.通根.數+=1;命盤.分析.四柱.四柱數據[3].通根.數+=1;}if(命盤.年干.五行==命盤.日支.五行){命盤.年干.通根.日=true;命盤.分析.四柱.四柱數據[0].通根.日=true;命盤.年干.通根.數+=1;命盤.分析.四柱.四柱數據[0].通根.數+=1;}if(命盤.年干.五行==命盤.時支.五行){命盤.年干.通根.時=true;命盤.分析.四柱.四柱數據[0].通根.時=true;命盤.年干.通根.數+=1;命盤.分析.四柱.四柱數據[0].通根.數+=1;}if(命盤.日柱.運星=="帝旺"||命盤.日柱.運星=="臨官"){命盤.分析.強弱.註解.push("自坐"+命盤.日柱.運星);if(命盤.日干.陰陽=="陽"&&命盤.日柱.運星=="帝旺"){命盤.日干.陽刃.日=true;命盤.日干.陽刃.數+=1;命盤.分析.四柱.四柱數據[2].陽刃.日=true;命盤.分析.四柱.四柱數據[2].陽刃.數+=1;}if(命盤.日干.陰陽=="陰"&&命盤.日柱.運星=="帝旺"){命盤.日干.帝旺.日=true;命盤.日干.帝旺.數+=1;命盤.分析.四柱.四柱數據[2].帝旺.日=true;命盤.分析.四柱.四柱數據[2].帝旺.數+=1;}if(命盤.日柱.運星=="臨官"){命盤.日干.生祿.日=true;命盤.日干.生祿.數+=1;命盤.分析.四柱.四柱數據[2].生祿.日=true;命盤.分析.四柱.四柱數據[2].生祿.數+=1;}}if(命盤.月柱.運星=="帝旺"||命盤.月柱.運星=="臨官"){if(命盤.日干.陰陽=="陽"&&命盤.月柱.運星=="帝旺"){命盤.日干.陽刃.月=true;命盤.日干.陽刃.數+=1;命盤.分析.四柱.四柱數據[2].陽刃.月=true;命盤.分析.四柱.四柱數據[2].陽刃.數+=1;}if(命盤.日干.陰陽=="陰"&&命盤.月柱.運星=="帝旺"){命盤.日干.帝旺.月=true;命盤.日干.帝旺.數+=1;命盤.分析.四柱.四柱數據[2].帝旺.月=true;命盤.分析.四柱.四柱數據[2].帝旺.數+=1;}if(命盤.月柱.運星=="臨官"){命盤.日干.生祿.月=true;命盤.日干.生祿.數+=1;命盤.分析.四柱.四柱數據[2].生祿.月=true;命盤.分析.四柱.四柱數據[2].生祿.數+=1;}}if(命盤.年柱.運星=="帝旺"||命盤.年柱.運星=="臨官"){if(命盤.日干.陰陽=="陽"&&命盤.年柱.運星=="帝旺"){命盤.日干.陽刃.年=true;命盤.日干.陽刃.數+=1;命盤.分析.四柱.四柱數據[2].陽刃.年=true;命盤.分析.四柱.四柱數據[2].陽刃.數+=1;}if(命盤.日干.陰陽=="陰"&&命盤.年柱.運星=="帝旺"){命盤.日干.帝旺.年=true;命盤.日干.帝旺.數+=1;命盤.分析.四柱.四柱數據[2].帝旺.年=true;命盤.分析.四柱.四柱數據[2].帝旺.數+=1;}if(命盤.年柱.運星=="臨官"){命盤.日干.生祿.年=true;命盤.日干.生祿.數+=1;命盤.分析.四柱.四柱數據[2].生祿.年=true;命盤.分析.四柱.四柱數據[2].生祿.數+=1;}}if(命盤.時柱.運星=="帝旺"||命盤.時柱.運星=="臨官"){if(命盤.日干.陰陽=="陽"&&命盤.時柱.運星=="帝旺"){命盤.日干.陽刃.時=true;命盤.日干.陽刃.數+=1;命盤.分析.四柱.四柱數據[2].陽刃.時=true;命盤.分析.四柱.四柱數據[2].陽刃.數+=1;}if(命盤.日干.陰陽=="陰"&&命盤.時柱.運星=="帝旺"){命盤.日干.帝旺.時=true;命盤.日干.帝旺.數+=1;命盤.分析.四柱.四柱數據[2].帝旺.時=true;命盤.分析.四柱.四柱數據[2].帝旺.數+=1;}if(命盤.時柱.運星=="臨官"){命盤.日干.生祿.時=true;命盤.日干.生祿.數+=1;命盤.分析.四柱.四柱數據[2].生祿.時=true;命盤.分析.四柱.四柱數據[2].生祿.數+=1;}}var 月干對年支運星=十二星運數轉字(十二星運(命盤.月干.天干,命盤.年支.地支));var 月干對月支運星=十二星運數轉字(十二星運(命盤.月干.天干,命盤.月支.地支));var 月干對日支運星=十二星運數轉字(十二星運(命盤.月干.天干,命盤.日支.地支));var 月干對時支運星=十二星運數轉字(十二星運(命盤.月干.天干,命盤.時支.地支));if(月干對月支運星=="帝旺"||月干對月支運星=="臨官"){if(命盤.月干.陰陽=="陽"&&月干對月支運星=="帝旺"){命盤.月干.陽刃.月=true;命盤.月干.陽刃.數+=1;命盤.分析.四柱.四柱數據[1].陽刃.月=true;命盤.分析.四柱.四柱數據[1].陽刃.數+=1;}if(命盤.月干.陰陽=="陰"&&月干對月支運星=="帝旺"){命盤.月干.帝旺.月=true;命盤.月干.帝旺.數+=1;命盤.分析.四柱.四柱數據[1].帝旺.月=true;命盤.分析.四柱.四柱數據[1].帝旺.數+=1;}if(月干對月支運星=="臨官"){命盤.月干.生祿.月=true;命盤.月干.生祿.數+=1;命盤.分析.四柱.四柱數據[1].生祿.月=true;命盤.分析.四柱.四柱數據[1].生祿.數+=1;}}if(月干對年支運星=="帝旺"||月干對年支運星=="臨官"){if(命盤.月干.陰陽=="陽"&&月干對年支運星=="帝旺"){命盤.月干.陽刃.年=true;命盤.月干.陽刃.數+=1;命盤.分析.四柱.四柱數據[1].陽刃.年=true;命盤.分析.四柱.四柱數據[1].陽刃.數+=1;}if(命盤.月干.陰陽=="陰"&&月干對年支運星=="帝旺"){命盤.月干.帝旺.年=true;命盤.月干.帝旺.數+=1;命盤.分析.四柱.四柱數據[1].帝旺.年=true;命盤.分析.四柱.四柱數據[1].帝旺.數+=1;}if(月干對年支運星=="臨官"){命盤.月干.生祿.年=true;命盤.月干.生祿.數+=1;命盤.分析.四柱.四柱數據[1].生祿.年=true;命盤.分析.四柱.四柱數據[1].生祿.數+=1;}}if(月干對日支運星=="帝旺"||月干對日支運星=="臨官"){if(命盤.月干.陰陽=="陽"&&月干對日支運星=="帝旺"){命盤.月干.陽刃.日=true;命盤.月干.陽刃.數+=1;命盤.分析.四柱.四柱數據[1].陽刃.日=true;命盤.分析.四柱.四柱數據[1].陽刃.數+=1;}if(命盤.月干.陰陽=="陰"&&月干對日支運星=="帝旺"){命盤.月干.帝旺.日=true;命盤.月干.帝旺.數+=1;命盤.分析.四柱.四柱數據[1].帝旺.日=true;命盤.分析.四柱.四柱數據[1].帝旺.數+=1;}if(月干對日支運星=="臨官"){命盤.月干.生祿.日=true;命盤.月干.生祿.數+=1;命盤.分析.四柱.四柱數據[1].生祿.日=true;命盤.分析.四柱.四柱數據[1].生祿.數+=1;}}if(月干對時支運星=="帝旺"||月干對時支運星=="臨官"){if(命盤.月干.陰陽=="陽"&&月干對時支運星=="帝旺"){命盤.月干.陽刃.時=true;命盤.月干.陽刃.數+=1;命盤.分析.四柱.四柱數據[1].陽刃.時=true;命盤.分析.四柱.四柱數據[1].陽刃.數+=1;}if(命盤.月干.陰陽=="陰"&&月干對時支運星=="帝旺"){命盤.月干.帝旺.時=true;命盤.月干.帝旺.數+=1;命盤.分析.四柱.四柱數據[1].帝旺.時=true;命盤.分析.四柱.四柱數據[1].帝旺.數+=1;}if(月干對時支運星=="臨官"){命盤.月干.生祿.時=true;命盤.月干.生祿.數+=1;命盤.分析.四柱.四柱數據[1].生祿.時=true;命盤.分析.四柱.四柱數據[1].生祿.數+=1;}}var 時干對年支運星=十二星運數轉字(十二星運(命盤.時干.天干,命盤.年支.地支));var 時干對月支運星=十二星運數轉字(十二星運(命盤.時干.天干,命盤.月支.地支));var 時干對日支運星=十二星運數轉字(十二星運(命盤.時干.天干,命盤.日支.地支));var 時干對時支運星=十二星運數轉字(十二星運(命盤.時干.天干,命盤.時支.地支));if(時干對時支運星=="帝旺"||時干對時支運星=="臨官"){if(命盤.時干.陰陽=="陽"&&時干對時支運星=="帝旺"){命盤.時干.陽刃.時=true;命盤.時干.陽刃.數+=1;命盤.分析.四柱.四柱數據[3].陽刃.時=true;命盤.分析.四柱.四柱數據[3].陽刃.數+=1;}if(命盤.時干.陰陽=="陰"&&時干對時支運星=="帝旺"){命盤.時干.帝旺.時=true;命盤.時干.帝旺.數+=1;命盤.分析.四柱.四柱數據[3].帝旺.時=true;命盤.分析.四柱.四柱數據[3].帝旺.數+=1;}if(時干對時支運星=="臨官"){命盤.時干.生祿.時=true;命盤.時干.生祿.數+=1;命盤.分析.四柱.四柱數據[3].生祿.時=true;命盤.分析.四柱.四柱數據[3].生祿.數+=1;}}if(時干對日支運星=="帝旺"||時干對日支運星=="臨官"){if(命盤.時干.陰陽=="陽"&&時干對日支運星=="帝旺"){命盤.時干.陽刃.日=true;命盤.時干.陽刃.數+=1;命盤.分析.四柱.四柱數據[3].陽刃.日=true;命盤.分析.四柱.四柱數據[3].陽刃.數+=1;}if(命盤.時干.陰陽=="陰"&&時干對日支運星=="帝旺"){命盤.時干.帝旺.日=true;命盤.時干.帝旺.數+=1;命盤.分析.四柱.四柱數據[3].帝旺.日=true;命盤.分析.四柱.四柱數據[3].帝旺.數+=1;}if(時干對日支運星=="臨官"){命盤.時干.生祿.日=true;命盤.時干.生祿.數+=1;命盤.分析.四柱.四柱數據[3].生祿.日=true;命盤.分析.四柱.四柱數據[3].生祿.數+=1;}}if(時干對月支運星=="帝旺"||時干對月支運星=="臨官"){if(命盤.時干.陰陽=="陽"&&時干對月支運星=="帝旺"){命盤.時干.陽刃.月=true;命盤.時干.陽刃.數+=1;命盤.分析.四柱.四柱數據[3].陽刃.月=true;命盤.分析.四柱.四柱數據[3].陽刃.數+=1;}if(命盤.時干.陰陽=="陰"&&時干對月支運星=="帝旺"){命盤.時干.帝旺.月=true;命盤.時干.帝旺.數+=1;命盤.分析.四柱.四柱數據[3].帝旺.月=true;命盤.分析.四柱.四柱數據[3].帝旺.數+=1;}if(時干對月支運星=="臨官"){命盤.時干.生祿.月=true;命盤.時干.生祿.數+=1;命盤.分析.四柱.四柱數據[3].生祿.月=true;命盤.分析.四柱.四柱數據[3].生祿.數+=1;}}if(時干對年支運星=="帝旺"||時干對年支運星=="臨官"){if(命盤.時干.陰陽=="陽"&&時干對年支運星=="帝旺"){命盤.時干.陽刃.年=true;命盤.時干.陽刃.數+=1;命盤.分析.四柱.四柱數據[3].陽刃.年=true;命盤.分析.四柱.四柱數據[3].陽刃.數+=1;}if(命盤.時干.陰陽=="陰"&&時干對年支運星=="帝旺"){命盤.時干.帝旺.年=true;命盤.時干.帝旺.數+=1;命盤.分析.四柱.四柱數據[3].帝旺.年=true;命盤.分析.四柱.四柱數據[3].帝旺.數+=1;}if(時干對年支運星=="臨官"){命盤.時干.生祿.年=true;命盤.時干.生祿.數+=1;命盤.分析.四柱.四柱數據[3].生祿.年=true;命盤.分析.四柱.四柱數據[3].生祿.數+=1;}}var 年干對年支運星=十二星運數轉字(十二星運(命盤.年干.天干,命盤.年支.地支));var 年干對月支運星=十二星運數轉字(十二星運(命盤.年干.天干,命盤.月支.地支));var 年干對日支運星=十二星運數轉字(十二星運(命盤.年干.天干,命盤.日支.地支));var 年干對時支運星=十二星運數轉字(十二星運(命盤.年干.天干,命盤.時支.地支));if(年干對年支運星=="帝旺"||年干對年支運星=="臨官"){if(命盤.年干.陰陽=="陽"&&年干對年支運星=="帝旺"){命盤.年干.陽刃.年=true;命盤.年干.陽刃.數+=1;命盤.分析.四柱.四柱數據[0].陽刃.年=true;命盤.分析.四柱.四柱數據[0].陽刃.數+=1;}if(命盤.年干.陰陽=="陰"&&年干對年支運星=="帝旺"){命盤.年干.帝旺.年=true;命盤.年干.帝旺.數+=1;命盤.分析.四柱.四柱數據[0].帝旺.年=true;命盤.分析.四柱.四柱數據[0].帝旺.數+=1;}if(年干對年支運星=="臨官"){命盤.年干.生祿.年=true;命盤.年干.生祿.數+=1;命盤.分析.四柱.四柱數據[0].生祿.年=true;命盤.分析.四柱.四柱數據[0].生祿.數+=1;}}if(年干對月支運星=="帝旺"||年干對月支運星=="臨官"){if(命盤.年干.陰陽=="陽"&&年干對月支運星=="帝旺"){命盤.年干.陽刃.月=true;命盤.年干.陽刃.數+=1;命盤.分析.四柱.四柱數據[0].陽刃.月=true;命盤.分析.四柱.四柱數據[0].陽刃.數+=1;}if(命盤.年干.陰陽=="陰"&&年干對月支運星=="帝旺"){命盤.年干.帝旺.月=true;命盤.年干.帝旺.數+=1;命盤.分析.四柱.四柱數據[0].帝旺.月=true;命盤.分析.四柱.四柱數據[0].帝旺.數+=1;}if(年干對月支運星=="臨官"){命盤.年干.生祿.月=true;命盤.年干.生祿.數+=1;命盤.分析.四柱.四柱數據[0].生祿.月=true;命盤.分析.四柱.四柱數據[0].生祿.數+=1;}}if(年干對日支運星=="帝旺"||年干對日支運星=="臨官"){if(命盤.年干.陰陽=="陽"&&年干對日支運星=="帝旺"){命盤.年干.陽刃.日=true;命盤.年干.陽刃.數+=1;命盤.分析.四柱.四柱數據[0].陽刃.日=true;命盤.分析.四柱.四柱數據[0].陽刃.數+=1;}if(命盤.年干.陰陽=="陰"&&年干對日支運星=="帝旺"){命盤.年干.帝旺.日=true;命盤.年干.帝旺.數+=1;命盤.分析.四柱.四柱數據[0].帝旺.日=true;命盤.分析.四柱.四柱數據[0].帝旺.數+=1;}if(年干對日支運星=="臨官"){命盤.年干.生祿.日=true;命盤.年干.生祿.數+=1;命盤.分析.四柱.四柱數據[0].生祿.日=true;命盤.分析.四柱.四柱數據[0].生祿.數+=1;}}if(年干對時支運星=="帝旺"||年干對時支運星=="臨官"){if(命盤.年干.陰陽=="陽"&&年干對時支運星=="帝旺"){命盤.年干.陽刃.時=true;命盤.年干.陽刃.數+=1;命盤.分析.四柱.四柱數據[0].陽刃.時=true;命盤.分析.四柱.四柱數據[0].陽刃.數+=1;}if(命盤.年干.陰陽=="陰"&&年干對時支運星=="帝旺"){命盤.年干.帝旺.時=true;命盤.年干.帝旺.數+=1;命盤.分析.四柱.四柱數據[0].帝旺.時=true;命盤.分析.四柱.四柱數據[0].帝旺.數+=1;}if(年干對時支運星=="臨官"){命盤.年干.生祿.時=true;命盤.年干.生祿.數+=1;命盤.分析.四柱.四柱數據[0].生祿.時==true;命盤.分析.四柱.四柱數據[0].生祿.數+=1;}}};function 地支透干(命盤){if(命盤.年支.五行==命盤.月干.五行){命盤.年支.透干.月=true;命盤.分析.四柱.四柱數據[0].透干.月=true;命盤.年支.透干.數+=1;命盤.分析.四柱.四柱數據[0].透干.數+=1;}if(命盤.年支.五行==命盤.日干.五行){命盤.年支.透干.日=true;命盤.分析.四柱.四柱數據[0].透干.日=true;命盤.年支.透干.數+=1;命盤.分析.四柱.四柱數據[0].透干.數+=1;}if(命盤.年支.五行==命盤.時干.五行){命盤.年支.透干.時=true;命盤.分析.四柱.四柱數據[0].透干.時=true;命盤.年支.透干.數+=1;命盤.分析.四柱.四柱數據[0].透干.數+=1;}if(命盤.月支.五行==命盤.年干.五行){命盤.月支.透干.年=true;命盤.分析.四柱.四柱數據[2].透干.年=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(命盤.月支.五行==命盤.日干.五行){命盤.月支.透干.日=true;命盤.分析.四柱.四柱數據[2].透干.日=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(命盤.月支.五行==命盤.時干.五行){命盤.月支.透干.時=true;命盤.分析.四柱.四柱數據[2].透干.時=true;命盤.月支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(命盤.日支.五行==命盤.年干.五行){命盤.日支.透干.年=true;命盤.分析.四柱.四柱數據[2].透干.年=true;命盤.日支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(命盤.日支.五行==命盤.月干.五行){命盤.日支.透干.月=true;命盤.分析.四柱.四柱數據[2].透干.月=true;命盤.日支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(命盤.日支.五行==命盤.時干.五行){命盤.日支.透干.時=true;命盤.分析.四柱.四柱數據[2].透干.時=true;命盤.日支.透干.數+=1;命盤.分析.四柱.四柱數據[2].透干.數+=1;}if(命盤.時支.五行==命盤.年干.五行){命盤.時支.透干.年=true;命盤.分析.四柱.四柱數據[3].透干.年=true;命盤.時支.透干.數+=1;命盤.分析.四柱.四柱數據[3].透干.數+=1;}if(命盤.時支.五行==命盤.月干.五行){命盤.時支.透干.月=true;命盤.分析.四柱.四柱數據[3].透干.月=true;命盤.時支.透干.數+=1;命盤.分析.四柱.四柱數據[3].透干.數+=1;}if(命盤.時支.五行==命盤.日干.五行){命盤.時支.透干.日=true;命盤.分析.四柱.四柱數據[3].透干.日=true;命盤.時支.透干.數+=1;命盤.分析.四柱.四柱數據[3].透干.數+=1;}};function 天干力度分析(命盤){var 年干地支含祿刃=0,月干地支含祿刃=0,日干地支含祿刃=0,時干地支含祿刃=0;var 自坐=1,隔一位=0.75,隔二位=0.5,隔三位=0.25,陽刃力度=0.5,生祿力度=0.35;var 祿刃註解=[];var 日干通根力量=0,月干通根力量=0,年干通根力量=0,時干通根力量=0,通根非月令坐基=1,通根註解=[];var 干支基數=命盤.系統參數.運算.干支基數*通根非月令坐基;var 陽刃帝旺臨官力量=0;if(命盤.日干.通根.年&&命盤.日干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔二位;祿刃註解.push("日干通根年支 +"+陽刃帝旺臨官力量);命盤.分析.強弱.註解.push("日干通根年支");日干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.日干.通根.時&&命盤.日干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔一位;祿刃註解.push("日干通根時支 +"+陽刃帝旺臨官力量);命盤.分析.強弱.註解.push("日干通根時支");日干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.月干.通根.年&&命盤.月干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔一位;祿刃註解.push("月干通根年支 +"+陽刃帝旺臨官力量);月干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.月干.通根.日&&命盤.月干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔一位;祿刃註解.push("月干通根日支 +"+陽刃帝旺臨官力量);月干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.月干.通根.時&&命盤.月干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔二位;祿刃註解.push("月干通根時支 +"+陽刃帝旺臨官力量);月干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.時干.通根.日&&命盤.時干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔一位;祿刃註解.push("時干通根日支 +"+陽刃帝旺臨官力量);時干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.時干.通根.年&&命盤.時干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔三位;祿刃註解.push("時干通根年支 +"+陽刃帝旺臨官力量);時干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.年干.通根.日&&命盤.年干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔二位;祿刃註解.push("年干通根日支 +"+陽刃帝旺臨官力量.toFixed(2));年干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.年干.通根.時&&命盤.年干.五行=="土"){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔三位;祿刃註解.push("年干通根時支 +"+陽刃帝旺臨官力量.toFixed(2));年干地支含祿刃+=陽刃帝旺臨官力量;}if(命盤.日干.陽刃.日){祿刃註解.push("日干坐陽刃 +0");命盤.分析.強弱.註解.push("自坐陽刃");}if(命盤.日干.帝旺.日){祿刃註解.push("日干坐帝旺 +0");命盤.分析.強弱.註解.push("自坐帝旺");}if(命盤.日干.生祿.日){祿刃註解.push("日干坐臨官 +0");命盤.分析.強弱.註解.push("自坐"+命盤.日柱.運星);}if(命盤.日干.陽刃.月){祿刃註解.push("日干月支坐陽刃 +0");命盤.分析.強弱.註解.push("日干月支坐陽刃");}if(命盤.日干.帝旺.月){祿刃註解.push("日干月支坐帝旺 +0");命盤.分析.強弱.註解.push("日干月支坐帝旺");}if(命盤.日干.生祿.月){祿刃註解.push("日干月支坐臨官 +0");命盤.分析.強弱.註解.push("日干月支坐臨官");}if(命盤.日干.陽刃.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔二位;日干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("日干年支有陽刃 +"+陽刃帝旺臨官力量.toFixed(2));命盤.分析.強弱.註解.push("日干年支有陽刃");}if(命盤.日干.帝旺.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔二位;日干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("日干年支坐帝旺 +"+陽刃帝旺臨官力量.toFixed(2));命盤.分析.強弱.註解.push("日干年支坐帝旺");}if(命盤.日干.生祿.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*生祿力度*隔二位;日干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("日干年支有臨官 +"+日干地支含祿刃.toFixed(2));命盤.分析.強弱.註解.push("日干年支有臨官");}if(命盤.日干.陽刃.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔一位;日干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("日干時支有陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));命盤.分析.強弱.註解.push("日干時支有陽刃");}if(命盤.日干.帝旺.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔一位;日干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("日干時支有帝旺 +"+陽刃帝旺臨官力量);命盤.分析.強弱.註解.push("日干時支有帝旺");}if(命盤.日干.生祿.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*生祿力度*隔一位;日干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("日干時支有臨官 +"+(陽刃帝旺臨官力量).toFixed(2));命盤.分析.強弱.註解.push("日干時支有臨官");}if(命盤.月干.陽刃.月){祿刃註解.push("月干坐陽刃 +0");}if(命盤.月干.帝旺.月){祿刃註解.push("月干坐帝旺 +0");}if(命盤.月干.生祿.月){祿刃註解.push("月干坐臨官 +0");}if(命盤.月干.陽刃.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干年支有陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.月干.帝旺.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干年支有帝旺 +"+陽刃帝旺臨官力量);}if(命盤.月干.生祿.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*生祿力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干年支有臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.月干.陽刃.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干日支有陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.月干.帝旺.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干日支坐帝旺 +"+陽刃帝旺臨官力量);}if(命盤.月干.生祿.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*生祿力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干日支有臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.月干.陽刃.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔二位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干時支坐陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.月干.帝旺.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔二位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干時支坐帝旺 +"+陽刃帝旺臨官力量);}if(命盤.月干.生祿.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*生祿力度*隔二位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("月干時支坐臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.時干.陽刃.時){祿刃註解.push("時干坐陽刃 +0");}if(命盤.時干.帝旺.時){祿刃註解.push("時干坐帝旺 +0");}if(命盤.時干.生祿.時){祿刃註解.push("時干坐臨官 +0");}if(命盤.時干.陽刃.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔三位;時干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("時干年支坐陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.時干.帝旺.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*陽刃力度*隔三位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("時干年支坐帝旺 +"+陽刃帝旺臨官力量);}if(命盤.時干.生祿.年){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"年柱")*生祿力度*隔三位;時干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("時干年支坐臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.時干.陽刃.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔一位;時干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("時干日支坐陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.時干.帝旺.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔一位;月干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("時干日支坐帝旺 +"+陽刃帝旺臨官力量);}if(命盤.時干.生祿.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*生祿力度*隔一位;時干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("時干日支坐臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.時干.陽刃.月){祿刃註解.push("時干月支坐陽刃 +0");}if(命盤.時干.帝旺.月){祿刃註解.push("時干月支坐帝旺 +0");}if(命盤.時干.生祿.月){祿刃註解.push("時干月支坐臨官 +0");}if(命盤.年干.陽刃.年){祿刃註解.push("年干坐陽刃 +0");}if(命盤.年干.帝旺.年){祿刃註解.push("年干坐帝旺 +0");}if(命盤.年干.生祿.年){祿刃註解.push("年干坐臨官 +0");}if(命盤.年干.陽刃.月){祿刃註解.push("年干月支坐陽刃 +0");}if(命盤.年干.帝旺.月){祿刃註解.push("年干月支坐帝旺 +0");}if(命盤.年干.生祿.月){祿刃註解.push("年干月支坐臨官 +0");}if(命盤.年干.陽刃.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔二位;年干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("年干日支坐陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.年干.帝旺.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*陽刃力度*隔二位;年干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("年干日支坐帝旺 +"+陽刃帝旺臨官力量);}if(命盤.年干.生祿.日){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"日柱")*生祿力度*隔二位;年干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("年干日支坐臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.年干.陽刃.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔三位;年干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("年干時支坐陽刃 +"+(陽刃帝旺臨官力量).toFixed(2));}if(命盤.年干.帝旺.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*陽刃力度*隔三位;年干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("年干時支坐帝旺 +"+陽刃帝旺臨官力量);}if(命盤.年干.生祿.時){陽刃帝旺臨官力量=干支基數*刑冲合會害影響比率(命盤,"時柱")*生祿力度*隔三位;年干地支含祿刃+=陽刃帝旺臨官力量;祿刃註解.push("年干時支坐臨官 +"+(陽刃帝旺臨官力量).toFixed(2));}var 天干力度矩陣=[];var 天干力度註解=[];var 力量基數=命盤.系統參數.運算.干支基數;var 時干月令函數=0.75;var 年干月令={"因素":"月令","條件":命盤.年柱.天干+"生於"+命盤.月令+"月","形態":日干月令對照(命盤.年柱.天干,命盤.月令,"旺相休囚死"),"力度加減":0};var 月干月令={"因素":"月令","條件":命盤.月柱.天干+"生於"+命盤.月令+"月","形態":日干月令對照(命盤.月柱.天干,命盤.月令,"旺相休囚死"),"力度加減":0};var 日干月令={"因素":"月令","條件":命盤.日柱.天干+"生於"+命盤.月令+"月","形態":日干月令對照(命盤.日柱.天干,命盤.月令,"旺相休囚死"),"力度加減":0};var 時干月令={"因素":"月令","條件":命盤.時柱.天干+"生於"+命盤.月令+"月","形態":日干月令對照(命盤.時柱.天干,命盤.月令,"旺相休囚死"),"力度加減":0};年干月令.力度加減=(月令旺相休囚死力度(日干月令對照(命盤.年柱.天干,命盤.月令,"旺相休囚死"))*力量基數*刑冲合會害影響比率(命盤,"年柱")).toFixed(1);月干月令.力度加減=(月令旺相休囚死力度(日干月令對照(命盤.月柱.天干,命盤.月令,"旺相休囚死"))*力量基數*刑冲合會害影響比率(命盤,"月柱")).toFixed(1);日干月令.力度加減=(月令旺相休囚死力度(日干月令對照(命盤.日柱.天干,命盤.月令,"旺相休囚死"))*力量基數*刑冲合會害影響比率(命盤,"日柱")).toFixed(1);時干月令.力度加減=(月令旺相休囚死力度(日干月令對照(命盤.時柱.天干,命盤.月令,"旺相休囚死"))*力量基數*刑冲合會害影響比率(命盤,"時柱")*時干月令函數).toFixed(1);var 月令因素=["月令",時干月令.力度加減,日干月令.力度加減,0,年干月令.力度加減,""];命盤.分析.強弱.註解.push("日主"+命盤.日柱.天干+"干生於"+命盤.月令+"月得"+日干月令.形態+"令");var 年干坐基={"因素":"坐基","條件":命盤.年柱.干支,"形態":六十干支屬性(命盤.年柱.干支,"干支關係"),"力度加減":0};var 月干坐基={"因素":"坐基","條件":命盤.月柱.干支,"形態":六十干支屬性(命盤.月柱.干支,"干支關係"),"力度加減":0};var 日干坐基={"因素":"坐基","條件":命盤.日柱.干支,"形態":六十干支屬性(命盤.日柱.干支,"干支關係"),"力度加減":0};var 時干坐基={"因素":"坐基","條件":命盤.時柱.干支,"形態":六十干支屬性(命盤.時柱.干支,"干支關係"),"力度加減":0};年干坐基.力度加減=(六十干支屬性(命盤.年柱.干支,"天干力度")*力量基數*刑冲合會害影響比率(命盤,"年柱")).toFixed(1);月干坐基.力度加減=(六十干支屬性(命盤.月柱.干支,"天干力度")*力量基數*刑冲合會害影響比率(命盤,"月柱")).toFixed(1);日干坐基.力度加減=(六十干支屬性(命盤.日柱.干支,"天干力度")*力量基數*刑冲合會害影響比率(命盤,"日柱")).toFixed(1);時干坐基.力度加減=(六十干支屬性(命盤.時柱.干支,"天干力度")*力量基數*刑冲合會害影響比率(命盤,"時柱")).toFixed(1);var 坐基因素=["坐基",時干坐基.力度加減,日干坐基.力度加減,月干坐基.力度加減,年干坐基.力度加減,""];命盤.分析.強弱.註解.push("日柱"+命盤.日柱.干支+"為"+日干坐基.形態);var 祿刃因素=["祿刃",時干地支含祿刃.toFixed(1),日干地支含祿刃.toFixed(1),月干地支含祿刃.toFixed(1),年干地支含祿刃.toFixed(1)];var 天干基數=["基數",力量基數,力量基數,力量基數,力量基數,""];if(祿刃註解.length>0)天干力度註解.push(祿刃註解.join("，"));天干力度矩陣=[天干基數,坐基因素,月令因素,祿刃因素];for(var i=0;i<命盤.分析.刑冲合會害表.length;i++){if(命盤.分析.刑冲合會害表[i][0]=="天干"&&命盤.分析.刑冲合會害表[i][13]==1){var 天干合化因素=[命盤.分析.刑冲合會害表[i][2]+命盤.分析.刑冲合會害表[i][16],命盤.分析.刑冲合會害表[i][9],命盤.分析.刑冲合會害表[i][10],命盤.分析.刑冲合會害表[i][11],命盤.分析.刑冲合會害表[i][12],命盤.分析.刑冲合會害表[i][15]];天干力度矩陣.push(天干合化因素);}}var 天干總和=SumArrayByColumn(天干力度矩陣,true,false,1,"fixed",1);命盤.年干.力量=parseFloat(天干總和[3]);命盤.月干.力量=parseFloat(天干總和[2]);命盤.日干.力量=parseFloat(天干總和[1]);命盤.時干.力量=parseFloat(天干總和[0]);天干總和.unshift("總和");天干總和.push("-");天干力度矩陣.push(天干總和);天干力度矩陣.unshift(["天干",命盤.時柱.天干,命盤.日柱.天干,命盤.月柱.天干,命盤.年柱.天干,"-"]);天干力度矩陣.unshift(["四柱","時柱","日柱","月柱","年柱","-"]);var ArryTblProp={"Caption":true,"CaptionStr":"天干力度表","CaptionCSS":"default","TableTitle":"","RowHeight":24,"ColumnWidth":[90,50,50,50,50],"HighligtedRow":[],"HighligtedCSS":"","FirstRowIsTitle":true,"FirstColIsTitle":true,"RowTitleCSS":"","ColTitleCSS":""};var 天干力度表=ArryToTable(RemoveColumnFromArray(天干力度矩陣,5),ArryTblProp);if(天干力度註解.length>0){var ulCSS='style="font:14px Trebuchet;"';var 天干力度註解字串=Array2UnorderedList(天干力度註解,"",ulCSS);天干力度表+=天干力度註解字串;}return 天干力度表;};function 地支力度分析(命盤){var 地支力度矩陣=[];var 地支力度註解=[];var 地支基數=命盤.系統參數.運算.干支基數;var 年支干頭={"因素":"干頭","條件":命盤.年柱.干支,"形態":六十干支屬性(命盤.年柱.干支,"干支關係"),"力度加減":0};var 月支干頭={"因素":"干頭","條件":命盤.月柱.干支,"形態":六十干支屬性(命盤.月柱.干支,"干支關係"),"力度加減":0};var 日支干頭={"因素":"干頭","條件":命盤.日柱.干支,"形態":六十干支屬性(命盤.日柱.干支,"干支關係"),"力度加減":0};var 時支干頭={"因素":"干頭","條件":命盤.時柱.干支,"形態":六十干支屬性(命盤.時柱.干支,"干支關係"),"力度加減":0};年支干頭.力度加減=六十干支屬性(命盤.年柱.干支,"地支力度")*地支基數;月支干頭.力度加減=六十干支屬性(命盤.月柱.干支,"地支力度")*地支基數;日支干頭.力度加減=六十干支屬性(命盤.日柱.干支,"地支力度")*地支基數;時支干頭.力度加減=六十干支屬性(命盤.時柱.干支,"地支力度")*地支基數;var 干頭因素=["干頭",時支干頭.力度加減.toFixed(1),日支干頭.力度加減.toFixed(1),月支干頭.力度加減.toFixed(1),年支干頭.力度加減.toFixed(1),""];var 地支基數=["基數",命盤.系統參數.運算.干支基數,命盤.系統參數.運算.干支基數,命盤.系統參數.運算.干支基數,命盤.系統參數.運算.干支基數,""];地支力度矩陣=[地支基數,干頭因素];var 自坐=1,隔一位=0.75,隔二位=0.5,隔三位=0.25,透干力度=0.5,通根非月令坐基=1;var 透干力量,日支透干力量=0,月支透干力量=0,年支透干力量=0,時支透干力量=0,透干註解=[];for(var i=0;i<命盤.分析.刑冲合會害表.length;i++){if(命盤.分析.刑冲合會害表[i][0]=="地支"&&命盤.分析.刑冲合會害表[i][13]==1&&命盤.分析.刑冲合會害表[i][13]=="相冲"){var 地支刑冲合會害因素=[命盤.分析.刑冲合會害表[i][2]+命盤.分析.刑冲合會害表[i][16],(命盤.分析.刑冲合會害表[i][9]).toFixed(1),(命盤.分析.刑冲合會害表[i][10]).toFixed(1),(命盤.分析.刑冲合會害表[i][11]).toFixed(1),(命盤.分析.刑冲合會害表[i][12]).toFixed(1),命盤.分析.刑冲合會害表[i][15]];地支力度矩陣.push(地支刑冲合會害因素);}}var 地支總和=SumArrayByColumn(地支力度矩陣,true,false,1,"fixed",1);命盤.年支.力量=parseFloat(地支總和[3]);命盤.月支.力量=parseFloat(地支總和[2]);命盤.日支.力量=parseFloat(地支總和[1]);命盤.時支.力量=parseFloat(地支總和[0]);地支總和.unshift("總和");地支總和.push("-");地支力度矩陣.push(地支總和);地支力度矩陣.unshift(["地支",命盤.時柱.地支,命盤.日柱.地支,命盤.月柱.地支,命盤.年柱.地支,"-"]);地支力度矩陣.unshift(["四柱","時柱","日柱","月柱","年柱","-"]);if(透干註解.length>0)地支力度註解.push(透干註解.join("，"));var ArryTblProp={"Caption":true,"CaptionStr":"地支力度表","CaptionCSS":"default","TableTitle":"","RowHeight":24,"ColumnWidth":[90,50,50,50,50],"HighligtedRow":[],"HighligtedCSS":"","FirstRowIsTitle":true,"FirstColIsTitle":true,"RowTitleCSS":"","ColTitleCSS":""};var 地支力度表=ArryToTable(RemoveColumnFromArray(地支力度矩陣,5),ArryTblProp);if(地支力度註解.length>0){var ulCSS='style="font:14px Trebuchet;"';var 地支力度註解字串=Array2UnorderedList(地支力度註解,"",ulCSS);地支力度表+=地支力度註解字串;}return 地支力度表;};function 五行合化力度分析(命盤){合會化力度矩陣=[];合會化力度矩陣.push(["合化五行","木","火","土","金","水"]);for(var i=0;i<命盤.分析.刑冲合會害表.length;i++){if(命盤.分析.刑冲合會害表[i][3]!=""&&命盤.分析.刑冲合會害表[i][13]==1){var 合化矩陣=五行位置輸入矩陣(命盤.分析.刑冲合會害表[i][3],(命盤.分析.刑冲合會害表[i][6]).toFixed(1),1,命盤.分析.刑冲合會害表[i][2]+命盤.分析.刑冲合會害表[i][16],0);合會化力度矩陣.push(合化矩陣);switch(命盤.分析.刑冲合會害表[i][3]){case "木":命盤.分析.陰陽五行.木.合化+=命盤.分析.刑冲合會害表[i][6];break;case "火":命盤.分析.陰陽五行.火.合化+=命盤.分析.刑冲合會害表[i][6];break;case "土":命盤.分析.陰陽五行.土.合化+=命盤.分析.刑冲合會害表[i][6];break;case "金":命盤.分析.陰陽五行.金.合化+=命盤.分析.刑冲合會害表[i][6];break;case "水":命盤.分析.陰陽五行.水.合化+=命盤.分析.刑冲合會害表[i][6];}}}if(合會化力度矩陣.length<=1)return "";var ArryTblProp={"Caption":true,"CaptionStr":"五行合化表","CaptionCSS":"default","TableTitle":"","RowHeight":24,"ColumnWidth":[120,60,60,60,60,60],"HighligtedRow":[],"HighligtedCSS":"","FirstRowIsTitle":true,"FirstColIsTitle":true,"RowTitleCSS":"","ColTitleCSS":""};var 五行合化表=ArryToTable(RemoveColumnFromArray(合會化力度矩陣,"-"),ArryTblProp);return 五行合化表;} 